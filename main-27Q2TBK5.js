import{a as Uh,b as Bh,c as qh,d as ko,e as Si,f as zh,g as Wh,h as Gh,i as Hh,j as Kh,k as Do,l as Ri,m as Qh,n as Pi,q as Jh,r as Ci,s as Yh,t as ki,u as Di,v as Ni}from"./chunk-I3ZFHGA6.js";import{a as jh,e as $h}from"./chunk-2OVMQB2Z.js";import{a as xh,c as Vh,d as Lh,g as Mh,h as Fh}from"./chunk-BI4YVVXI.js";import"./chunk-Z5O26QON.js";import{$ as Ih,A as Ro,Aa as gn,Bb as Dh,Bc as Oh,Da as bi,Fa as Sh,G as mn,H as qe,Ha as Rh,J as ze,Ja as Ph,K as dh,Kc as Co,L as fh,La as xe,N as wi,Na as Ch,O as ph,P as mh,R as gh,U as Po,Ua as kh,Wb as Nh,X as _h,_ as yh,a as Te,b as Ue,ba as vh,da as Ft,ea as Ti,f as yt,ga as Eh,ha as wh,i as sh,ia as Th,j as oh,k as ah,l as ch,m as Ei,ma as _e,o as uh,p as Ao,pa as Ce,q as fr,qa as te,qb as Ve,r as bo,ra as oe,s as So,sa as We,t as pr,ta as Ah,u as lh,va as bh,wa as Ai,x as hh,y as Pe}from"./chunk-2STITFBG.js";var Xh=()=>{};var td=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},i_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Oi={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,u=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,m=o>>2,g=(o&3)<<4|u>>4,w=(u&15)<<2|d>>6,C=d&63;h||(C=64,a||(w=64)),r.push(t[m],t[g],t[w],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(td(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):i_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let g=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||g==null)throw new Oo;let w=o<<2|u>>4;if(r.push(w),d!==64){let C=u<<4&240|d>>2;if(r.push(C),g!==64){let S=d<<6&192|g;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Oo=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},s_=function(n){let e=td(n);return Oi.encodeByteArray(e,!0)},gr=function(n){return s_(n).replace(/\./g,"")},xi=function(n){try{return Oi.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Vo(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var o_=()=>Vo().__FIREBASE_DEFAULTS__,a_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},c_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&xi(n[1]);return e&&JSON.parse(e)},Vi=()=>{try{return Xh()||o_()||a_()||c_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Lo=n=>{var e,t;return(t=(e=Vi())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},nd=n=>{let e=Lo(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Mo=()=>{var n;return(n=Vi())===null||n===void 0?void 0:n.config},Fo=n=>{var e;return(e=Vi())===null||e===void 0?void 0:e[`_${n}`]};var Ut=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function It(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Li(n){return(await fetch(n,{credentials:"include"})).ok}function rd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[gr(JSON.stringify(t)),gr(JSON.stringify(a)),""].join(".")}var mr={};function u_(){let n={prod:[],emulator:[]};for(let e of Object.keys(mr))mr[e]?n.emulator.push(e):n.prod.push(e);return n}function l_(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var Zh=!1;function Mi(n,e){if(typeof window>"u"||typeof document>"u"||!It(window.location.host)||mr[n]===e||mr[n]||Zh)return;mr[n]=e;function t(w){return`__firebase__banner__${w}`}let r="__firebase__banner",o=u_().prod.length>0;function a(){let w=document.getElementById(r);w&&w.remove()}function u(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function h(w,C){w.setAttribute("width","24"),w.setAttribute("id",C),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function d(){let w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{Zh=!0,a()},w}function m(w,C){w.setAttribute("id",C),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function g(){let w=l_(r),C=t("text"),S=document.getElementById(C)||document.createElement("span"),k=t("learnmore"),N=document.getElementById(k)||document.createElement("a"),U=t("preprendIcon"),F=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){let $=w.element;u($),m(N,k);let V=d();h(F,U),$.append(F,S,N,V),document.body.appendChild($)}o?(S.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function id(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ue())}function h_(){var n;let e=(n=Vi())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function od(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ad(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cd(){let n=ue();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ud(){return!h_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _r(){try{return typeof indexedDB=="object"}catch{return!1}}function ld(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var d_="FirebaseError",ke=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=d_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Be.prototype.create)}},Be=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?f_(o,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new ke(i,u,r)}};function f_(n,e){return n.replace(p_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var p_=/\{\$([^}]+)}/g;function hd(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ge(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(ed(o)&&ed(a)){if(!Ge(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function ed(n){return n!==null&&typeof n=="object"}function yr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function _n(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function yn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function dd(n,e){let t=new xo(n,e);return t.subscribe.bind(t)}var xo=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");m_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=No),i.error===void 0&&(i.error=No),i.complete===void 0&&(i.complete=No);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function m_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function No(){}var gA=14400*1e3;function Ae(n){return n&&n._delegate?n._delegate:n}var be=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Bt="[DEFAULT]";var Uo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ut;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(__(e))try{this.getOrInitializeService({instanceIdentifier:Bt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Bt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bt){return this.instances.has(e)}getOptions(e=Bt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(o);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:g_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Bt){return this.component?this.component.multipleInstances?e:Bt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function g_(n){return n===Bt?void 0:n}function __(n){return n.instantiationMode==="EAGER"}var Fi=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Uo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var y_=[],q=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(q||{}),I_={debug:q.DEBUG,verbose:q.VERBOSE,info:q.INFO,warn:q.WARN,error:q.ERROR,silent:q.SILENT},v_=q.INFO,E_={[q.DEBUG]:"log",[q.VERBOSE]:"log",[q.INFO]:"info",[q.WARN]:"warn",[q.ERROR]:"error"},w_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=E_[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},He=class{constructor(e){this.name=e,this._logLevel=v_,this._logHandler=w_,this._userLogHandler=null,y_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?I_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,q.DEBUG,...e),this._logHandler(this,q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,q.VERBOSE,...e),this._logHandler(this,q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,q.INFO,...e),this._logHandler(this,q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,q.WARN,...e),this._logHandler(this,q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,q.ERROR,...e),this._logHandler(this,q.ERROR,...e)}};var T_=(n,e)=>e.some(t=>n instanceof t),fd,pd;function A_(){return fd||(fd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function b_(){return pd||(pd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var md=new WeakMap,jo=new WeakMap,gd=new WeakMap,Bo=new WeakMap,qo=new WeakMap;function S_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Ke(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&md.set(t,n)}).catch(()=>{}),qo.set(e,n),e}function R_(n){if(jo.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});jo.set(n,e)}var $o={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return jo.get(n);if(e==="objectStoreNames")return n.objectStoreNames||gd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ke(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _d(n){$o=n($o)}function P_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Ui(this),e,...t);return gd.set(r,e.sort?e.sort():[e]),Ke(r)}:b_().includes(n)?function(...e){return n.apply(Ui(this),e),Ke(md.get(this))}:function(...e){return Ke(n.apply(Ui(this),e))}}function C_(n){return typeof n=="function"?P_(n):(n instanceof IDBTransaction&&R_(n),T_(n,A_())?new Proxy(n,$o):n)}function Ke(n){if(n instanceof IDBRequest)return S_(n);if(Bo.has(n))return Bo.get(n);let e=C_(n);return e!==n&&(Bo.set(n,e),qo.set(e,n)),e}var Ui=n=>qo.get(n);function Id(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),u=Ke(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Ke(a.result),h.oldVersion,h.newVersion,Ke(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var k_=["get","getKey","getAll","getAllKeys","count"],D_=["put","add","delete","clear"],zo=new Map;function yd(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(zo.get(e))return zo.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=D_.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||k_.includes(t)))return;let o=async function(a,...u){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),i&&h.done]))[0]};return zo.set(e,o),o}_d(n=>Ue(Te({},n),{get:(e,t,r)=>yd(e,t)||n.get(e,t,r),has:(e,t)=>!!yd(e,t)||n.has(e,t)}));var Go=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(N_(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function N_(n){let e=n.getComponent();return e?.type==="VERSION"}var Ho="@firebase/app",vd="0.13.2";var it=new He("@firebase/app"),O_="@firebase/app-compat",x_="@firebase/analytics-compat",V_="@firebase/analytics",L_="@firebase/app-check-compat",M_="@firebase/app-check",F_="@firebase/auth",U_="@firebase/auth-compat",B_="@firebase/database",j_="@firebase/data-connect",$_="@firebase/database-compat",q_="@firebase/functions",z_="@firebase/functions-compat",W_="@firebase/installations",G_="@firebase/installations-compat",H_="@firebase/messaging",K_="@firebase/messaging-compat",Q_="@firebase/performance",J_="@firebase/performance-compat",Y_="@firebase/remote-config",X_="@firebase/remote-config-compat",Z_="@firebase/storage",ey="@firebase/storage-compat",ty="@firebase/firestore",ny="@firebase/ai",ry="@firebase/firestore-compat",iy="firebase",sy="11.10.0";var Ko="[DEFAULT]",oy={[Ho]:"fire-core",[O_]:"fire-core-compat",[V_]:"fire-analytics",[x_]:"fire-analytics-compat",[M_]:"fire-app-check",[L_]:"fire-app-check-compat",[F_]:"fire-auth",[U_]:"fire-auth-compat",[B_]:"fire-rtdb",[j_]:"fire-data-connect",[$_]:"fire-rtdb-compat",[q_]:"fire-fn",[z_]:"fire-fn-compat",[W_]:"fire-iid",[G_]:"fire-iid-compat",[H_]:"fire-fcm",[K_]:"fire-fcm-compat",[Q_]:"fire-perf",[J_]:"fire-perf-compat",[Y_]:"fire-rc",[X_]:"fire-rc-compat",[Z_]:"fire-gcs",[ey]:"fire-gcs-compat",[ty]:"fire-fst",[ry]:"fire-fst-compat",[ny]:"fire-vertex","fire-js":"fire-js",[iy]:"fire-js-all"};var Ir=new Map,ay=new Map,Qo=new Map;function Ed(n,e){try{n.container.addComponent(e)}catch(t){it.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function je(n){let e=n.name;if(Qo.has(e))return it.debug(`There were multiple attempts to register component ${e}.`),!1;Qo.set(e,n);for(let t of Ir.values())Ed(t,n);for(let t of ay.values())Ed(t,n);return!0}function In(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Se(n){return n==null?!1:n.settings!==void 0}var cy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vt=new Be("app","Firebase",cy);var Jo=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new be("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vt.create("app-deleted",{appName:this._name})}};var Et=sy;function Zo(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Ko,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw vt.create("bad-app-name",{appName:String(i)});if(t||(t=Mo()),!t)throw vt.create("no-options");let o=Ir.get(i);if(o){if(Ge(t,o.options)&&Ge(r,o.config))return o;throw vt.create("duplicate-app",{appName:i})}let a=new Fi(i);for(let h of Qo.values())a.addComponent(h);let u=new Jo(t,r,a);return Ir.set(i,u),u}function jt(n=Ko){let e=Ir.get(n);if(!e&&n===Ko&&Mo())return Zo();if(!e)throw vt.create("no-app",{appName:n});return e}function Bi(){return Array.from(Ir.values())}function X(n,e,t){var r;let i=(r=oy[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),it.warn(u.join(" "));return}je(new be(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var uy="firebase-heartbeat-database",ly=1,vr="firebase-heartbeat-store",Wo=null;function bd(){return Wo||(Wo=Id(uy,ly,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(vr)}catch(t){console.warn(t)}}}}).catch(n=>{throw vt.create("idb-open",{originalErrorMessage:n.message})})),Wo}async function hy(n){try{let t=(await bd()).transaction(vr),r=await t.objectStore(vr).get(Sd(n));return await t.done,r}catch(e){if(e instanceof ke)it.warn(e.message);else{let t=vt.create("idb-get",{originalErrorMessage:e?.message});it.warn(t.message)}}}async function wd(n,e){try{let r=(await bd()).transaction(vr,"readwrite");await r.objectStore(vr).put(e,Sd(n)),await r.done}catch(t){if(t instanceof ke)it.warn(t.message);else{let r=vt.create("idb-set",{originalErrorMessage:t?.message});it.warn(r.message)}}}function Sd(n){return`${n.name}!${n.options.appId}`}var dy=1024,fy=30,Yo=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Xo(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Td();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>fy){let a=my(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){it.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Td(),{heartbeatsToSend:r,unsentEntries:i}=py(this._heartbeatsCache.heartbeats),o=gr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return it.warn(t),""}}};function Td(){return new Date().toISOString().substring(0,10)}function py(n,e=dy){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),Ad(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Ad(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Xo=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _r()?ld().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await hy(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return wd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return wd(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function Ad(n){return gr(JSON.stringify({version:2,heartbeats:n})).length}function my(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function gy(n){je(new be("platform-logger",e=>new Go(e),"PRIVATE")),je(new be("heartbeat",e=>new Yo(e),"PRIVATE")),X(Ho,vd,n),X(Ho,vd,"esm2017"),X("fire-js","")}gy("");var _y="firebase",yy="11.10.0";X(_y,yy,"app");var wt=new wh("ANGULARFIRE2_VERSION");function Er(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var wn=(n,e)=>{let t=e?[e]:Bi(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},vn=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(vn||{}),Rd=Co()&&typeof Zone<"u"?vn.WARN:vn.SILENT;var ji=class{zone;delegate;constructor(e,t=Ei){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(o,t,r)}},Tt=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=oe(Ve);this.outsideAngular=t.runOutsideAngular(()=>new ji(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ji(typeof Zone>"u"?void 0:Zone.current,ch))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=_e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pd=!1;function Iy(n,e){!Pd&&(Rd>vn.SILENT||Co())&&(Pd=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Rd>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function vy(n){let e=oe(Ve,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function $t(n){let e=oe(Ve,{optional:!0});return e?e.run(()=>n()):n()}var Ey=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),Ai(t,()=>$t(()=>n.apply(void 0,r)))),Le=(n,e,t)=>(t||=e?vn.WARN:vn.VERBOSE,function(){let r,i=arguments,o,a,u;try{o=oe(Tt),a=oe(Ph),u=oe(bh)}catch{return Iy(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=$t(()=>a.add())),i[d]=Ey(i[d],r,u));let h=vy(()=>n.apply(this,i));return e?h instanceof yt?h.pipe(bo(o.outsideAngular),fr(o.insideAngular),Bh(u)):h instanceof Promise?$t(()=>{let d=a.add();return new Promise((m,g)=>{h.then(w=>Ai(u,()=>$t(()=>m(w))),w=>Ai(u,()=>$t(()=>g(w)))).finally(d)})}):typeof h=="function"&&r?function(){return setTimeout(r,0),h.apply(this,arguments)}:$t(()=>h):h instanceof yt?h.pipe(bo(o.outsideAngular),fr(o.insideAngular)):$t(()=>h)});var st=class{constructor(e){return e}},qt=class{constructor(){return Bi()}};function wy(n){return n&&n.length===1?n[0]:new st(jt())}var ea=new Ce("angularfire2._apps"),Ty={provide:st,useFactory:wy,deps:[[new xe,ea]]},Ay={provide:qt,deps:[[new xe,ea]]};function by(n){return(e,t)=>{let r=t.get(kh);X("angularfire",wt.full,"core"),X("angularfire",wt.full,"app"),X("angular",Th.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new st(i)}}function Cd(n,...e){return We([Ty,Ay,{provide:ea,useFactory:by(n),multi:!0,deps:[Ve,gn,Tt,...e]}])}var kd=Le(Zo,!0);var Sy=new Map,Ry={activated:!1,tokenObservers:[]},Py={initialized:!1,enabled:!1};function $e(n){return Sy.get(n)||Object.assign({},Ry)}function xd(){return Py}var Cy="https://content-firebaseappcheck.googleapis.com/v1";var ky="exchangeDebugToken",Dd={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},ub=1440*60*1e3;var ra=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Ut,this.pending.promise.catch(t=>{}),await Dy(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Ut,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Dy(n){return new Promise(e=>{setTimeout(e,n)})}var Ny={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},At=new Be("appCheck","AppCheck",Ny);function Vd(n){if(!$e(n).activated)throw At.create("use-before-activation",{appName:n.name})}async function Ld({url:n,body:e},t){let r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){let g=await i.getHeartbeatsHeader();g&&(r["X-Firebase-Client"]=g)}let o={method:"POST",body:JSON.stringify(e),headers:r},a;try{a=await fetch(n,o)}catch(g){throw At.create("fetch-network-error",{originalErrorMessage:g?.message})}if(a.status!==200)throw At.create("fetch-status-error",{httpStatus:a.status});let u;try{u=await a.json()}catch(g){throw At.create("fetch-parse-error",{originalErrorMessage:g?.message})}let h=u.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw At.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let d=Number(h[1])*1e3,m=Date.now();return{token:u.token,expireTimeMillis:m+d,issuedAtTimeMillis:m}}function Md(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${Cy}/projects/${t}/apps/${r}:${ky}?key=${i}`,body:{debug_token:e}}}var Oy="firebase-app-check-database",xy=1,ia="firebase-app-check-store";var $i=null;function Vy(){return $i||($i=new Promise((n,e)=>{try{let t=indexedDB.open(Oy,xy);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(At.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(ia,{keyPath:"compositeKey"})}}}catch(t){e(At.create("storage-open",{originalErrorMessage:t?.message}))}}),$i)}function Ly(n,e){return My(Fy(n),e)}async function My(n,e){let r=(await Vy()).transaction(ia,"readwrite"),o=r.objectStore(ia).put({compositeKey:n,value:e});return new Promise((a,u)=>{o.onsuccess=h=>{a()},r.onerror=h=>{var d;u(At.create("storage-set",{originalErrorMessage:(d=h.target.error)===null||d===void 0?void 0:d.message}))}})}function Fy(n){return`${n.options.appId}-${n.name}`}var wr=new He("@firebase/app-check");function ta(n,e){return _r()?Ly(n,e).catch(t=>{wr.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Fd(){return xd().enabled}async function Ud(){let n=xd();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}var Uy={error:"UNKNOWN_ERROR"};function By(n){return Oi.encodeString(JSON.stringify(n),!1)}async function sa(n,e=!1,t=!1){let r=n.app;Vd(r);let i=$e(r),o=i.token,a;if(o&&!Tr(o)&&(i.token=void 0,o=void 0),!o){let d=await i.cachedTokenPromise;d&&(Tr(d)?o=d:await ta(r,void 0))}if(!e&&o&&Tr(o))return{token:o.token};let u=!1;if(Fd())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=Ld(Md(r,await Ud()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);let d=await i.exchangeTokenPromise;return await ta(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?wr.warn(d.message):t&&wr.error(d),na(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),o=await $e(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?wr.warn(d.message):t&&wr.error(d),a=d}let h;return o?a?Tr(o)?h={token:o.token,internalError:a}:h=na(a):(h={token:o.token},i.token=o,await ta(r,o)):h=na(a),u&&zy(r,h),h}async function jy(n){let e=n.app;Vd(e);let{provider:t}=$e(e);if(Fd()){let r=await Ud(),{token:i}=await Ld(Md(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=await t.getToken();return{token:r}}}function $y(n,e,t,r){let{app:i}=n,o=$e(i),a={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,a],o.token&&Tr(o.token)){let u=o.token;Promise.resolve().then(()=>{t({token:u.token}),Nd(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>Nd(n))}function Bd(n,e){let t=$e(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Nd(n){let{app:e}=n,t=$e(e),r=t.tokenRefresher;r||(r=qy(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function qy(n){let{app:e}=n;return new ra(async()=>{let t=$e(e),r;if(t.token?r=await sa(n,!0):r=await sa(n),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let t=$e(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Dd.RETRIAL_MIN_WAIT,Dd.RETRIAL_MAX_WAIT)}function zy(n,e){let t=$e(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Tr(n){return n.expireTimeMillis-Date.now()>0}function na(n){return{token:By(Uy),error:n}}var oa=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=$e(this.app);for(let t of e)Bd(this.app,t.next);return Promise.resolve()}};function Wy(n,e){return new oa(n,e)}function Gy(n){return{getToken:e=>sa(n,e),getLimitedUseToken:()=>jy(n),addTokenListener:e=>$y(n,"INTERNAL",e),removeTokenListener:e=>Bd(n.app,e)}}var Hy="@firebase/app-check",Ky="0.10.1";var Qy="app-check",Od="app-check-internal";function Jy(){je(new be(Qy,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Wy(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Od).initialize()})),je(new be(Od,n=>{let e=n.getProvider("app-check").getImmediate();return Gy(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),X(Hy,Ky)}Jy();var Yy="app-check";var Tn=class{constructor(){return wn(Yy)}};var Xy=["localhost","0.0.0.0","127.0.0.1"],Eb=typeof window<"u"&&Xy.includes(window.location.hostname);function nf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var rf=nf,sf=new Be("auth","Firebase",nf());var Ki=new He("@firebase/auth");function Zy(n,...e){Ki.logLevel<=q.WARN&&Ki.warn(`Auth (${Et}): ${n}`,...e)}function zi(n,...e){Ki.logLevel<=q.ERROR&&Ki.error(`Auth (${Et}): ${n}`,...e)}function Je(n,...e){throw Da(n,...e)}function zt(n,...e){return Da(n,...e)}function of(n,e,t){let r=Object.assign(Object.assign({},rf()),{[e]:t});return new Be("auth","Firebase",r).create(e,{appName:n.name})}function ct(n){return of(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Da(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return sf.create(n,...e)}function L(n,e,...t){if(!n)throw Da(e,...t)}function ot(n){let e="INTERNAL ASSERTION FAILED: "+n;throw zi(e),new Error(e)}function Rt(n,e){n||ot(e)}function la(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function eI(){return jd()==="http:"||jd()==="https:"}function jd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function tI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(eI()||od()||"connection"in navigator)?navigator.onLine:!0}function nI(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Wt=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Rt(t>e,"Short delay should be less than long delay!"),this.isMobile=id()||ad()}get(){return tI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Na(n,e){Rt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Qi=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ot("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ot("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ot("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var rI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var iI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sI=new Wt(3e4,6e4);function Pt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ct(n,e,t,r,i={}){return af(n,i,async()=>{let o={},a={};r&&(e==="GET"?a=r:o={body:JSON.stringify(r)});let u=yr(Object.assign({key:n.config.apiKey},a)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);let d=Object.assign({method:e,headers:h},o);return sd()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&It(n.emulatorConfig.host)&&(d.credentials="include"),Qi.fetch()(await cf(n,n.config.apiHost,t,u),d)})}async function af(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},rI),e);try{let i=new ha(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=await o.json();if("needConfirmation"in a)throw qi(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let u=o.ok?a.errorMessage:a.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw qi(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw qi(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw qi(n,"user-disabled",a);let m=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw of(n,m,d);Je(n,m)}}catch(i){if(i instanceof ke)throw i;Je(n,"network-request-failed",{message:String(i)})}}async function Nr(n,e,t,r,i={}){let o=await Ct(n,e,t,r,i);return"mfaPendingCredential"in o&&Je(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function cf(n,e,t,r){let i=`${e}${t}?${r}`,o=n,a=o.config.emulator?Na(n.config,i):`${n.config.apiScheme}://${i}`;return iI.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}function oI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var ha=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(zt(this.auth,"network-request-failed")),sI.get())})}};function qi(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=zt(n,e,r);return i.customData._tokenResponse=t,i}function $d(n){return n!==void 0&&n.enterprise!==void 0}var da=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return oI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function aI(n,e){return Ct(n,"GET","/v2/recaptchaConfig",Pt(n,e))}async function cI(n,e){return Ct(n,"POST","/v1/accounts:delete",e)}async function Ji(n,e){return Ct(n,"POST","/v1/accounts:lookup",e)}function br(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Oa(n,e=!1){let t=Ae(n),r=await t.getIdToken(e),i=xa(r);L(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:br(aa(i.auth_time)),issuedAtTime:br(aa(i.iat)),expirationTime:br(aa(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}function aa(n){return Number(n)*1e3}function xa(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return zi("JWT malformed, contained fewer than 3 sections"),null;try{let i=xi(t);return i?JSON.parse(i):(zi("Failed to decode base64 JWT payload"),null)}catch(i){return zi("Caught error parsing JWT payload as JSON",i?.toString()),null}}function qd(n){let e=xa(n);return L(e,"internal-error"),L(typeof e.exp<"u","internal-error"),L(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Rr(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ke&&uI(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function uI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var fa=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Pr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=br(this.lastLoginAt),this.creationTime=br(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Yi(n){var e;let t=n.auth,r=await n.getIdToken(),i=await Rr(n,Ji(t,{idToken:r}));L(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?uf(o.providerUserInfo):[],u=lI(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!u?.length,m=h?d:!1,g={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Pr(o.createdAt,o.lastLoginAt),isAnonymous:m};Object.assign(n,g)}async function Va(n){let e=Ae(n);await Yi(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lI(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function uf(n){return n.map(e=>{var{providerId:t}=e,r=Ao(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function hI(n,e){let t=await af(n,{},async()=>{let r=yr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=await cf(n,i,"/v1/token",`key=${o}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";let h={method:"POST",headers:u,body:r};return n.emulatorConfig&&It(n.emulatorConfig.host)&&(h.credentials="include"),Qi.fetch()(a,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function dI(n,e){return Ct(n,"POST","/v2/accounts:revokeToken",Pt(n,e))}var Sr=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){L(e.idToken,"internal-error"),L(typeof e.idToken<"u","internal-error"),L(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){L(e.length!==0,"internal-error");let t=qd(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(L(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:o}=await hI(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(L(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(L(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(L(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ot("not implemented")}};function bt(n,e){L(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var St=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=Ao(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fa(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Pr(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){let t=await Rr(this,this.stsTokenManager.getToken(this.auth,e));return L(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Oa(this,e)}reload(){return Va(this)}_assign(e){this!==e&&(L(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){L(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Yi(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Se(this.auth.app))return Promise.reject(ct(this.auth));let e=await this.getIdToken();return await Rr(this,cI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,u,h,d,m;let g=(r=t.displayName)!==null&&r!==void 0?r:void 0,w=(i=t.email)!==null&&i!==void 0?i:void 0,C=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,S=(a=t.photoURL)!==null&&a!==void 0?a:void 0,k=(u=t.tenantId)!==null&&u!==void 0?u:void 0,N=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,U=(d=t.createdAt)!==null&&d!==void 0?d:void 0,F=(m=t.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:$,emailVerified:V,isAnonymous:H,providerData:M,stsTokenManager:v}=t;L($&&v,e,"internal-error");let p=Sr.fromJSON(this.name,v);L(typeof $=="string",e,"internal-error"),bt(g,e.name),bt(w,e.name),L(typeof V=="boolean",e,"internal-error"),L(typeof H=="boolean",e,"internal-error"),bt(C,e.name),bt(S,e.name),bt(k,e.name),bt(N,e.name),bt(U,e.name),bt(F,e.name);let _=new n({uid:$,auth:e,email:w,emailVerified:V,displayName:g,isAnonymous:H,photoURL:S,phoneNumber:C,tenantId:k,stsTokenManager:p,createdAt:U,lastLoginAt:F});return M&&Array.isArray(M)&&(_.providerData=M.map(I=>Object.assign({},I))),N&&(_._redirectEventId=N),_}static async _fromIdTokenResponse(e,t,r=!1){let i=new Sr;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Yi(o),o}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];L(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?uf(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,u=new Sr;u.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Pr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h}};var zd=new Map;function at(n){Rt(n instanceof Function,"Expected a class definition");let e=zd.get(n);return e?(Rt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,zd.set(n,e),e)}var fI=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),pa=fI;function Wi(n,e,t){return`firebase:${n}:${e}:${t}`}var Xi=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Wi(this.userKey,i.apiKey,o),this.fullPersistenceKey=Wi("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Ji(this.auth,{idToken:e}).catch(()=>{});return t?St._fromGetAccountInfoResponse(this.auth,t,e):null}return St._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(at(pa),e,r);let i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d),o=i[0]||at(pa),a=Wi(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let m=await d._get(a);if(m){let g;if(typeof m=="string"){let w=await Ji(e,{idToken:m}).catch(()=>{});if(!w)break;g=await St._fromGetAccountInfoResponse(e,w,m)}else g=St._fromJSON(e,m);d!==o&&(u=g),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],u&&await o._set(a,u.toJSON()),await Promise.all(t.map(async d=>{if(d!==o)try{await d._remove(a)}catch{}})),new n(o,e,r))}};function Wd(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ff(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mf(e))return"Blackberry";if(gf(e))return"Webos";if(hf(e))return"Safari";if((e.includes("chrome/")||df(e))&&!e.includes("edge/"))return"Chrome";if(pf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function lf(n=ue()){return/firefox\//i.test(n)}function hf(n=ue()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function df(n=ue()){return/crios\//i.test(n)}function ff(n=ue()){return/iemobile/i.test(n)}function pf(n=ue()){return/android/i.test(n)}function mf(n=ue()){return/blackberry/i.test(n)}function gf(n=ue()){return/webos/i.test(n)}function La(n=ue()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pI(n=ue()){var e;return La(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function mI(){return cd()&&document.documentMode===10}function _f(n=ue()){return La(n)||pf(n)||gf(n)||mf(n)||/windows phone/i.test(n)||ff(n)}function yf(n,e=[]){let t;switch(n){case"Browser":t=Wd(ue());break;case"Worker":t=`${Wd(ue())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Et}/${r}`}var ma=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,u)=>{try{let h=e(o);a(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function gI(n,e={}){return Ct(n,"GET","/v2/passwordPolicy",Pt(n,e))}var _I=6,ga=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:_I,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,u;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var _a=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zi(this),this.idTokenSubscription=new Zi(this),this.beforeStateQueue=new ma(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=at(t)),this._initializationPromise=this.queue(async()=>{var r,i,o;if(!this._deleted&&(this.persistenceManager=await Xi.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Ji(this,{idToken:e}),r=await St._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Se(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!a||a===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return L(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Yi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=nI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Se(this.app))return Promise.reject(ct(this));let t=e?Ae(e):null;return t&&L(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&L(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Se(this.app)?Promise.reject(ct(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Se(this.app)?Promise.reject(ct(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(at(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await gI(this),t=new ga(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Be("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await dI(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&at(e)||this._popupRedirectResolver;L(t,this,"argument-error"),this.redirectPersistenceManager=await Xi.create(this,[at(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(L(u,this,"internal-error"),u.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return L(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(Se(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&Zy(`Error while retrieving App Check token: ${t.error}`),t?.token}};function Ht(n){return Ae(n)}var Zi=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=dd(t=>this.observer=t)}get next(){return L(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var os={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yI(n){os=n}function If(n){return os.loadJS(n)}function II(){return os.recaptchaEnterpriseScript}function vI(){return os.gapiScript}function vf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var ya=class{constructor(){this.enterprise=new Ia}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Ia=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var EI="recaptcha-enterprise",Ef="NO_RECAPTCHA",va=class{constructor(e){this.type=EI,this.auth=Ht(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,u)=>{aI(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{let d=new da(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,a(d.siteKey)}}).catch(h=>{u(h)})})}function i(o,a,u){let h=window.grecaptcha;$d(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{a(d)}).catch(()=>{a(Ef)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new ya().execute("siteKey",{action:"verify"}):new Promise((o,a)=>{r(this.auth).then(u=>{if(!t&&$d(window.grecaptcha))i(u,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let h=II();h.length!==0&&(h+=u),If(h).then(()=>{i(u,o,a)}).catch(d=>{a(d)})}}).catch(u=>{a(u)})})}};async function Ar(n,e,t,r=!1,i=!1){let o=new va(n),a;if(i)a=Ef;else try{a=await o.verify(t)}catch{a=await o.verify(t,!0)}let u=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){let h=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){let h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Ea(n,e,t,r,i){var o,a;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let u=await Ar(n,e,t,t==="getOobCode");return r(n,u)}else return r(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let h=await Ar(n,e,t,t==="getOobCode");return r(n,h)}else return Promise.reject(u)});else if(i==="PHONE_PROVIDER")if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("PHONE_PROVIDER")){let u=await Ar(n,e,t);return r(n,u).catch(async h=>{var d;if(((d=n._getRecaptchaConfig())===null||d===void 0?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(h.code==="auth/missing-recaptcha-token"||h.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let m=await Ar(n,e,t,!1,!0);return r(n,m)}return Promise.reject(h)})}else{let u=await Ar(n,e,t,!1,!0);return r(n,u)}else return Promise.reject(i+" provider is not supported.")}function Ma(n,e){let t=In(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Ge(o,e??{}))return i;Je(i,"already-initialized")}return t.initialize({options:e})}function wI(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(at);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Fa(n,e,t){let r=Ht(n);L(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=wf(e),{host:a,port:u}=TI(e),h=u===null?"":`:${u}`,d={url:`${o}//${a}${h}/`},m=Object.freeze({host:a,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){L(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),L(Ge(d,r.config.emulator)&&Ge(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,It(a)?(Li(`${o}//${a}${h}`),Mi("Auth",!0)):i||AI()}function wf(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function TI(n){let e=wf(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Gd(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:Gd(a)}}}function Gd(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function AI(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Cr=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ot("not implemented")}_getIdTokenResponse(e){return ot("not implemented")}_linkToIdToken(e,t){return ot("not implemented")}_getReauthenticationResolver(e){return ot("not implemented")}};async function bI(n,e){return Ct(n,"POST","/v1/accounts:signUp",e)}async function SI(n,e){return Nr(n,"POST","/v1/accounts:signInWithPassword",Pt(n,e))}async function RI(n,e){return Nr(n,"POST","/v1/accounts:signInWithEmailLink",Pt(n,e))}async function PI(n,e){return Nr(n,"POST","/v1/accounts:signInWithEmailLink",Pt(n,e))}var kr=class n extends Cr{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ea(e,t,"signInWithPassword",SI,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return RI(e,{email:this._email,oobCode:this._password});default:Je(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ea(e,r,"signUpPassword",bI,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return PI(e,{idToken:t,email:this._email,oobCode:this._password});default:Je(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function ca(n,e){return Nr(n,"POST","/v1/accounts:signInWithIdp",Pt(n,e))}function CI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function kI(n){let e=_n(yn(n)).link,t=e?_n(yn(e)).deep_link_id:null,r=_n(yn(n)).deep_link_id;return(r?_n(yn(r)).link:null)||r||t||e||n}var es=class n{constructor(e){var t,r,i,o,a,u;let h=_n(yn(e)),d=(t=h.apiKey)!==null&&t!==void 0?t:null,m=(r=h.oobCode)!==null&&r!==void 0?r:null,g=CI((i=h.mode)!==null&&i!==void 0?i:null);L(d&&m&&g,"argument-error"),this.apiKey=d,this.operation=g,this.code=m,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=h.lang)!==null&&a!==void 0?a:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){let t=kI(e);try{return new n(t)}catch{return null}}};var Tf=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return kr._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=es.parseLink(r);return L(i,"argument-error"),kr._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),ts=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var wa=class extends ts{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};async function DI(n,e){return Nr(n,"POST","/v1/accounts:signUp",Pt(n,e))}var An=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let o=await St._fromIdTokenResponse(e,r,i),a=Hd(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=Hd(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function Hd(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Ta=class n extends ke{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Af(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Ta._fromErrorAndOperation(n,o,e,r):o})}async function NI(n,e,t=!1){let r=await Rr(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return An._forOperation(n,"link",r)}async function OI(n,e,t=!1){let{auth:r}=n;if(Se(r.app))return Promise.reject(ct(r));let i="reauthenticate";try{let o=await Rr(n,Af(r,i,e,n),t);L(o.idToken,r,"internal-error");let a=xa(o.idToken);L(a,r,"internal-error");let{sub:u}=a;return L(n.uid===u,r,"user-mismatch"),An._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&Je(r,"user-mismatch"),o}}async function bf(n,e,t=!1){if(Se(n.app))return Promise.reject(ct(n));let r="signIn",i=await Af(n,r,e),o=await An._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function Ua(n,e){return bf(Ht(n),e)}async function Sf(n){let e=Ht(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Ba(n,e,t){if(Se(n.app))return Promise.reject(ct(n));let r=Ht(n),a=await Ea(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",DI,"EMAIL_PASSWORD_PROVIDER").catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&Sf(n),h}),u=await An._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(u.user),u}function ja(n,e,t){return Se(n.app)?Promise.reject(ct(n)):Ua(Ae(n),Tf.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Sf(n),r})}function $a(n,e,t,r){return Ae(n).onIdTokenChanged(e,t,r)}function qa(n,e,t){return Ae(n).beforeAuthStateChanged(e,t)}function za(n){return Ae(n).signOut()}var ns="__sak";var rs=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ns,"1"),this.storage.removeItem(ns),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var xI=1e3,VI=10,LI=(()=>{class n extends rs{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_f(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,h,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);mI()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,VI):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},xI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),Rf=LI;var MI=(()=>{class n extends rs{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Wa=MI;function FI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var UI=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:o,data:a}=r.data,u=this.handlersMap[o];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(u).map(async m=>m(r.origin,a)),d=await FI(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Pf(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Aa=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((u,h)=>{let d=Pf("",20);i.port1.start();let m=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(g){let w=g;if(w.data.eventId===d)switch(w.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(w.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}};function Qe(){return window}function BI(n){Qe().location.href=n}function Cf(){return typeof Qe().WorkerGlobalScope<"u"&&typeof Qe().importScripts=="function"}async function jI(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $I(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function qI(){return Cf()?self:null}var kf="firebaseLocalStorageDb",zI=1,is="firebaseLocalStorage",Df="fbase_key",Gt=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function as(n,e){return n.transaction([is],e?"readwrite":"readonly").objectStore(is)}function WI(){let n=indexedDB.deleteDatabase(kf);return new Gt(n).toPromise()}function ba(){let n=indexedDB.open(kf,zI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(is,{keyPath:Df})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(is)?e(r):(r.close(),await WI(),e(await ba()))})})}async function Kd(n,e,t){let r=as(n,!0).put({[Df]:e,value:t});return new Gt(r).toPromise()}async function GI(n,e){let t=as(n,!1).get(e),r=await new Gt(t).toPromise();return r===void 0?null:r.value}function Qd(n,e){let t=as(n,!0).delete(e);return new Gt(t).toPromise()}var HI=800,KI=3,QI=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ba(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>KI)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Cf()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=UI._getInstance(qI()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await jI(),!this.activeServiceWorker)return;this.sender=new Aa(this.activeServiceWorker);let i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||$I()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await ba();return await Kd(t,ns,"1"),await Qd(t,ns),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>Kd(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>GI(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Qd(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(o=>{let a=as(o,!1).getAll();return new Gt(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),HI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Nf=QI;var Cb=vf("rcb"),kb=new Wt(3e4,6e4);function JI(n,e){return e?at(e):(L(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Dr=class extends Cr{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ca(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ca(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ca(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function YI(n){return bf(n.auth,new Dr(n),n.bypassAuthState)}function XI(n){let{auth:e,user:t}=n;return L(t,e,"internal-error"),OI(t,new Dr(n),n.bypassAuthState)}async function ZI(n){let{auth:e,user:t}=n;return L(t,e,"internal-error"),NI(t,new Dr(n),n.bypassAuthState)}var Sa=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:u}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return YI;case"linkViaPopup":case"linkViaRedirect":return ZI;case"reauthViaPopup":case"reauthViaRedirect":return XI;default:Je(this.auth,"internal-error")}}resolve(e){Rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Db=new Wt(2e3,1e4);var ev="pendingRedirect",Gi=new Map,Ra=class extends Sa{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Gi.get(this.auth._key());if(!e){try{let r=await tv(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Gi.set(this.auth._key(),e)}return this.bypassAuthState||Gi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function tv(n,e){let t=iv(e),r=rv(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function nv(n,e){Gi.set(n._key(),e)}function rv(n){return at(n._redirectPersistence)}function iv(n){return Wi(ev,n.config.apiKey,n.name)}async function sv(n,e,t=!1){if(Se(n.app))return Promise.reject(ct(n));let r=Ht(n),i=JI(r,e),a=await new Ra(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}var ov=600*1e3,Pa=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!av(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Of(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(zt(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ov&&this.cachedEventUids.clear(),this.cachedEventUids.has(Jd(e))}saveEventToCache(e){this.cachedEventUids.add(Jd(e)),this.lastProcessedEventTime=Date.now()}};function Jd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Of({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function av(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Of(n);default:return!1}}async function cv(n,e={}){return Ct(n,"GET","/v1/projects",e)}var uv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lv=/^https?/;async function hv(n){if(n.config.emulator)return;let{authorizedDomains:e}=await cv(n);for(let t of e)try{if(dv(t))return}catch{}Je(n,"unauthorized-domain")}function dv(n){let e=la(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!lv.test(t))return!1;if(uv.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var fv=new Wt(3e4,6e4);function Yd(){let n=Qe().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function pv(n){return new Promise((e,t)=>{var r,i,o;function a(){Yd(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Yd(),t(zt(n,"network-request-failed"))},timeout:fv.get()})}if(!((i=(r=Qe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Qe().gapi)===null||o===void 0)&&o.load)a();else{let u=vf("iframefcb");return Qe()[u]=()=>{gapi.load?a():t(zt(n,"network-request-failed"))},If(`${vI()}?onload=${u}`).catch(h=>t(h))}}).catch(e=>{throw Hi=null,e})}var Hi=null;function mv(n){return Hi=Hi||pv(n),Hi}var gv=new Wt(5e3,15e3),_v="__/auth/iframe",yv="emulator/auth/iframe",Iv={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vv=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ev(n){let e=n.config;L(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Na(e,yv):`https://${n.config.authDomain}/${_v}`,r={apiKey:e.apiKey,appName:n.name,v:Et},i=vv.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${yr(r).slice(1)}`}async function wv(n){let e=await mv(n),t=Qe().gapi;return L(t,n,"internal-error"),e.open({where:document.body,url:Ev(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Iv,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});let a=zt(n,"network-request-failed"),u=Qe().setTimeout(()=>{o(a)},gv.get());function h(){Qe().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(a)})}))}var Tv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Av=500,bv=600,Sv="_blank",Rv="http://localhost",ss=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Pv(n,e,t,r=Av,i=bv){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",h=Object.assign(Object.assign({},Tv),{width:r.toString(),height:i.toString(),top:o,left:a}),d=ue().toLowerCase();t&&(u=df(d)?Sv:t),lf(d)&&(e=e||Rv,h.scrollbars="yes");let m=Object.entries(h).reduce((w,[C,S])=>`${w}${C}=${S},`,"");if(pI(d)&&u!=="_self")return Cv(e||"",u),new ss(null);let g=window.open(e||"",u,m);L(g,n,"popup-blocked");try{g.focus()}catch{}return new ss(g)}function Cv(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var kv="__/auth/handler",Dv="emulator/auth/handler",Nv=encodeURIComponent("fac");async function Xd(n,e,t,r,i,o){L(n.config.authDomain,n,"auth-domain-config-required"),L(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Et,eventId:i};if(e instanceof ts){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",hd(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[m,g]of Object.entries(o||{}))a[m]=g}if(e instanceof wa){let m=e.getScopes().filter(g=>g!=="");m.length>0&&(a.scopes=m.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let m of Object.keys(u))u[m]===void 0&&delete u[m];let h=await n._getAppCheckToken(),d=h?`#${Nv}=${encodeURIComponent(h)}`:"";return`${Ov(n)}?${yr(u).slice(1)}${d}`}function Ov({config:n}){return n.emulator?Na(n,Dv):`https://${n.authDomain}/${kv}`}var ua="webStorageSupport",Ca=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Wa,this._completeRedirectFn=sv,this._overrideRedirectResult=nv}async _openPopup(e,t,r,i){var o;Rt((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=await Xd(e,t,r,la(),i);return Pv(e,a,Pf())}async _openRedirect(e,t,r,i){await this._originValidation(e);let o=await Xd(e,t,r,la(),i);return BI(o),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Rt(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await wv(e),r=new Pa(e);return t.register("authEvent",i=>(L(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ua,{type:ua},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[ua];a!==void 0&&t(!!a),Je(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=hv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _f()||hf()||La()}},xf=Ca;var Zd="@firebase/auth",ef="1.10.8";var ka=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){L(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function xv(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Vv(n){je(new be("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;L(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yf(n)},d=new _a(r,i,o,h);return wI(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),je(new be("auth-internal",e=>{let t=Ht(e.getProvider("auth").getImmediate());return(r=>new ka(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),X(Zd,ef,xv(n)),X(Zd,ef,"esm2017")}var Lv=300,Mv=Fo("authIdTokenMaxAge")||Lv,tf=null,Fv=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Mv)return;let i=t?.token;tf!==i&&(tf=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Ga(n=jt()){let e=In(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Ma(n,{popupRedirectResolver:xf,persistence:[Nf,Rf,Wa]}),r=Fo("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=Fv(o.toString());qa(t,a,()=>a(t.currentUser)),$a(t,u=>a(u))}}let i=Lo("auth");return i&&Fa(t,`http://${i}`),t}function Uv(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}yI({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=zt("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",Uv().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Vv("Browser");var Vf="auth",Kt=class{constructor(e){return e}},Or=class{constructor(){return wn(Vf)}};var Ha=new Ce("angularfire2.auth-instances");function PE(n,e){let t=Er(Vf,n,e);return t&&new Kt(t)}function CE(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Kt(r)}}var kE={provide:Or,deps:[[new xe,Ha]]},DE={provide:Kt,useFactory:PE,deps:[[new xe,Ha],st]};function Lf(n,...e){return X("angularfire",wt.full,"auth"),We([DE,kE,{provide:Ha,useFactory:CE(n),multi:!0,deps:[Ve,gn,Tt,qt,[new xe,Tn],...e]}])}var Mf=Le(Ba,!0,2);var Ff=Le(Ga,!0);var Uf=Le(ja,!0,2);var Bf=Le(za,!0,2);var jf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$f={};var cs,qf;(function(){var n;function e(v,p){function _(){}_.prototype=p.prototype,v.D=p.prototype,v.prototype=new _,v.prototype.constructor=v,v.C=function(I,E,A){for(var y=Array(arguments.length-2),tt=2;tt<arguments.length;tt++)y[tt-2]=arguments[tt];return p.prototype[E].apply(I,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(v,p,_){_||(_=0);var I=Array(16);if(typeof p=="string")for(var E=0;16>E;++E)I[E]=p.charCodeAt(_++)|p.charCodeAt(_++)<<8|p.charCodeAt(_++)<<16|p.charCodeAt(_++)<<24;else for(E=0;16>E;++E)I[E]=p[_++]|p[_++]<<8|p[_++]<<16|p[_++]<<24;p=v.g[0],_=v.g[1],E=v.g[2];var A=v.g[3],y=p+(A^_&(E^A))+I[0]+3614090360&4294967295;p=_+(y<<7&4294967295|y>>>25),y=A+(E^p&(_^E))+I[1]+3905402710&4294967295,A=p+(y<<12&4294967295|y>>>20),y=E+(_^A&(p^_))+I[2]+606105819&4294967295,E=A+(y<<17&4294967295|y>>>15),y=_+(p^E&(A^p))+I[3]+3250441966&4294967295,_=E+(y<<22&4294967295|y>>>10),y=p+(A^_&(E^A))+I[4]+4118548399&4294967295,p=_+(y<<7&4294967295|y>>>25),y=A+(E^p&(_^E))+I[5]+1200080426&4294967295,A=p+(y<<12&4294967295|y>>>20),y=E+(_^A&(p^_))+I[6]+2821735955&4294967295,E=A+(y<<17&4294967295|y>>>15),y=_+(p^E&(A^p))+I[7]+4249261313&4294967295,_=E+(y<<22&4294967295|y>>>10),y=p+(A^_&(E^A))+I[8]+1770035416&4294967295,p=_+(y<<7&4294967295|y>>>25),y=A+(E^p&(_^E))+I[9]+2336552879&4294967295,A=p+(y<<12&4294967295|y>>>20),y=E+(_^A&(p^_))+I[10]+4294925233&4294967295,E=A+(y<<17&4294967295|y>>>15),y=_+(p^E&(A^p))+I[11]+2304563134&4294967295,_=E+(y<<22&4294967295|y>>>10),y=p+(A^_&(E^A))+I[12]+1804603682&4294967295,p=_+(y<<7&4294967295|y>>>25),y=A+(E^p&(_^E))+I[13]+4254626195&4294967295,A=p+(y<<12&4294967295|y>>>20),y=E+(_^A&(p^_))+I[14]+2792965006&4294967295,E=A+(y<<17&4294967295|y>>>15),y=_+(p^E&(A^p))+I[15]+1236535329&4294967295,_=E+(y<<22&4294967295|y>>>10),y=p+(E^A&(_^E))+I[1]+4129170786&4294967295,p=_+(y<<5&4294967295|y>>>27),y=A+(_^E&(p^_))+I[6]+3225465664&4294967295,A=p+(y<<9&4294967295|y>>>23),y=E+(p^_&(A^p))+I[11]+643717713&4294967295,E=A+(y<<14&4294967295|y>>>18),y=_+(A^p&(E^A))+I[0]+3921069994&4294967295,_=E+(y<<20&4294967295|y>>>12),y=p+(E^A&(_^E))+I[5]+3593408605&4294967295,p=_+(y<<5&4294967295|y>>>27),y=A+(_^E&(p^_))+I[10]+38016083&4294967295,A=p+(y<<9&4294967295|y>>>23),y=E+(p^_&(A^p))+I[15]+3634488961&4294967295,E=A+(y<<14&4294967295|y>>>18),y=_+(A^p&(E^A))+I[4]+3889429448&4294967295,_=E+(y<<20&4294967295|y>>>12),y=p+(E^A&(_^E))+I[9]+568446438&4294967295,p=_+(y<<5&4294967295|y>>>27),y=A+(_^E&(p^_))+I[14]+3275163606&4294967295,A=p+(y<<9&4294967295|y>>>23),y=E+(p^_&(A^p))+I[3]+4107603335&4294967295,E=A+(y<<14&4294967295|y>>>18),y=_+(A^p&(E^A))+I[8]+1163531501&4294967295,_=E+(y<<20&4294967295|y>>>12),y=p+(E^A&(_^E))+I[13]+2850285829&4294967295,p=_+(y<<5&4294967295|y>>>27),y=A+(_^E&(p^_))+I[2]+4243563512&4294967295,A=p+(y<<9&4294967295|y>>>23),y=E+(p^_&(A^p))+I[7]+1735328473&4294967295,E=A+(y<<14&4294967295|y>>>18),y=_+(A^p&(E^A))+I[12]+2368359562&4294967295,_=E+(y<<20&4294967295|y>>>12),y=p+(_^E^A)+I[5]+4294588738&4294967295,p=_+(y<<4&4294967295|y>>>28),y=A+(p^_^E)+I[8]+2272392833&4294967295,A=p+(y<<11&4294967295|y>>>21),y=E+(A^p^_)+I[11]+1839030562&4294967295,E=A+(y<<16&4294967295|y>>>16),y=_+(E^A^p)+I[14]+4259657740&4294967295,_=E+(y<<23&4294967295|y>>>9),y=p+(_^E^A)+I[1]+2763975236&4294967295,p=_+(y<<4&4294967295|y>>>28),y=A+(p^_^E)+I[4]+1272893353&4294967295,A=p+(y<<11&4294967295|y>>>21),y=E+(A^p^_)+I[7]+4139469664&4294967295,E=A+(y<<16&4294967295|y>>>16),y=_+(E^A^p)+I[10]+3200236656&4294967295,_=E+(y<<23&4294967295|y>>>9),y=p+(_^E^A)+I[13]+681279174&4294967295,p=_+(y<<4&4294967295|y>>>28),y=A+(p^_^E)+I[0]+3936430074&4294967295,A=p+(y<<11&4294967295|y>>>21),y=E+(A^p^_)+I[3]+3572445317&4294967295,E=A+(y<<16&4294967295|y>>>16),y=_+(E^A^p)+I[6]+76029189&4294967295,_=E+(y<<23&4294967295|y>>>9),y=p+(_^E^A)+I[9]+3654602809&4294967295,p=_+(y<<4&4294967295|y>>>28),y=A+(p^_^E)+I[12]+3873151461&4294967295,A=p+(y<<11&4294967295|y>>>21),y=E+(A^p^_)+I[15]+530742520&4294967295,E=A+(y<<16&4294967295|y>>>16),y=_+(E^A^p)+I[2]+3299628645&4294967295,_=E+(y<<23&4294967295|y>>>9),y=p+(E^(_|~A))+I[0]+4096336452&4294967295,p=_+(y<<6&4294967295|y>>>26),y=A+(_^(p|~E))+I[7]+1126891415&4294967295,A=p+(y<<10&4294967295|y>>>22),y=E+(p^(A|~_))+I[14]+2878612391&4294967295,E=A+(y<<15&4294967295|y>>>17),y=_+(A^(E|~p))+I[5]+4237533241&4294967295,_=E+(y<<21&4294967295|y>>>11),y=p+(E^(_|~A))+I[12]+1700485571&4294967295,p=_+(y<<6&4294967295|y>>>26),y=A+(_^(p|~E))+I[3]+2399980690&4294967295,A=p+(y<<10&4294967295|y>>>22),y=E+(p^(A|~_))+I[10]+4293915773&4294967295,E=A+(y<<15&4294967295|y>>>17),y=_+(A^(E|~p))+I[1]+2240044497&4294967295,_=E+(y<<21&4294967295|y>>>11),y=p+(E^(_|~A))+I[8]+1873313359&4294967295,p=_+(y<<6&4294967295|y>>>26),y=A+(_^(p|~E))+I[15]+4264355552&4294967295,A=p+(y<<10&4294967295|y>>>22),y=E+(p^(A|~_))+I[6]+2734768916&4294967295,E=A+(y<<15&4294967295|y>>>17),y=_+(A^(E|~p))+I[13]+1309151649&4294967295,_=E+(y<<21&4294967295|y>>>11),y=p+(E^(_|~A))+I[4]+4149444226&4294967295,p=_+(y<<6&4294967295|y>>>26),y=A+(_^(p|~E))+I[11]+3174756917&4294967295,A=p+(y<<10&4294967295|y>>>22),y=E+(p^(A|~_))+I[2]+718787259&4294967295,E=A+(y<<15&4294967295|y>>>17),y=_+(A^(E|~p))+I[9]+3951481745&4294967295,v.g[0]=v.g[0]+p&4294967295,v.g[1]=v.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,v.g[2]=v.g[2]+E&4294967295,v.g[3]=v.g[3]+A&4294967295}r.prototype.u=function(v,p){p===void 0&&(p=v.length);for(var _=p-this.blockSize,I=this.B,E=this.h,A=0;A<p;){if(E==0)for(;A<=_;)i(this,v,A),A+=this.blockSize;if(typeof v=="string"){for(;A<p;)if(I[E++]=v.charCodeAt(A++),E==this.blockSize){i(this,I),E=0;break}}else for(;A<p;)if(I[E++]=v[A++],E==this.blockSize){i(this,I),E=0;break}}this.h=E,this.o+=p},r.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var p=1;p<v.length-8;++p)v[p]=0;var _=8*this.o;for(p=v.length-8;p<v.length;++p)v[p]=_&255,_/=256;for(this.u(v),v=Array(16),p=_=0;4>p;++p)for(var I=0;32>I;I+=8)v[_++]=this.g[p]>>>I&255;return v};function o(v,p){var _=u;return Object.prototype.hasOwnProperty.call(_,v)?_[v]:_[v]=p(v)}function a(v,p){this.h=p;for(var _=[],I=!0,E=v.length-1;0<=E;E--){var A=v[E]|0;I&&A==p||(_[E]=A,I=!1)}this.g=_}var u={};function h(v){return-128<=v&&128>v?o(v,function(p){return new a([p|0],0>p?-1:0)}):new a([v|0],0>v?-1:0)}function d(v){if(isNaN(v)||!isFinite(v))return g;if(0>v)return N(d(-v));for(var p=[],_=1,I=0;v>=_;I++)p[I]=v/_|0,_*=4294967296;return new a(p,0)}function m(v,p){if(v.length==0)throw Error("number format error: empty string");if(p=p||10,2>p||36<p)throw Error("radix out of range: "+p);if(v.charAt(0)=="-")return N(m(v.substring(1),p));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(p,8)),I=g,E=0;E<v.length;E+=8){var A=Math.min(8,v.length-E),y=parseInt(v.substring(E,E+A),p);8>A?(A=d(Math.pow(p,A)),I=I.j(A).add(d(y))):(I=I.j(_),I=I.add(d(y)))}return I}var g=h(0),w=h(1),C=h(16777216);n=a.prototype,n.m=function(){if(k(this))return-N(this).m();for(var v=0,p=1,_=0;_<this.g.length;_++){var I=this.i(_);v+=(0<=I?I:4294967296+I)*p,p*=4294967296}return v},n.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(S(this))return"0";if(k(this))return"-"+N(this).toString(v);for(var p=d(Math.pow(v,6)),_=this,I="";;){var E=V(_,p).g;_=U(_,E.j(p));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(v);if(_=E,S(_))return A+I;for(;6>A.length;)A="0"+A;I=A+I}},n.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function S(v){if(v.h!=0)return!1;for(var p=0;p<v.g.length;p++)if(v.g[p]!=0)return!1;return!0}function k(v){return v.h==-1}n.l=function(v){return v=U(this,v),k(v)?-1:S(v)?0:1};function N(v){for(var p=v.g.length,_=[],I=0;I<p;I++)_[I]=~v.g[I];return new a(_,~v.h).add(w)}n.abs=function(){return k(this)?N(this):this},n.add=function(v){for(var p=Math.max(this.g.length,v.g.length),_=[],I=0,E=0;E<=p;E++){var A=I+(this.i(E)&65535)+(v.i(E)&65535),y=(A>>>16)+(this.i(E)>>>16)+(v.i(E)>>>16);I=y>>>16,A&=65535,y&=65535,_[E]=y<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function U(v,p){return v.add(N(p))}n.j=function(v){if(S(this)||S(v))return g;if(k(this))return k(v)?N(this).j(N(v)):N(N(this).j(v));if(k(v))return N(this.j(N(v)));if(0>this.l(C)&&0>v.l(C))return d(this.m()*v.m());for(var p=this.g.length+v.g.length,_=[],I=0;I<2*p;I++)_[I]=0;for(I=0;I<this.g.length;I++)for(var E=0;E<v.g.length;E++){var A=this.i(I)>>>16,y=this.i(I)&65535,tt=v.i(E)>>>16,Kn=v.i(E)&65535;_[2*I+2*E]+=y*Kn,F(_,2*I+2*E),_[2*I+2*E+1]+=A*Kn,F(_,2*I+2*E+1),_[2*I+2*E+1]+=y*tt,F(_,2*I+2*E+1),_[2*I+2*E+2]+=A*tt,F(_,2*I+2*E+2)}for(I=0;I<p;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=p;I<2*p;I++)_[I]=0;return new a(_,0)};function F(v,p){for(;(v[p]&65535)!=v[p];)v[p+1]+=v[p]>>>16,v[p]&=65535,p++}function $(v,p){this.g=v,this.h=p}function V(v,p){if(S(p))throw Error("division by zero");if(S(v))return new $(g,g);if(k(v))return p=V(N(v),p),new $(N(p.g),N(p.h));if(k(p))return p=V(v,N(p)),new $(N(p.g),p.h);if(30<v.g.length){if(k(v)||k(p))throw Error("slowDivide_ only works with positive integers.");for(var _=w,I=p;0>=I.l(v);)_=H(_),I=H(I);var E=M(_,1),A=M(I,1);for(I=M(I,2),_=M(_,2);!S(I);){var y=A.add(I);0>=y.l(v)&&(E=E.add(_),A=y),I=M(I,1),_=M(_,1)}return p=U(v,E.j(p)),new $(E,p)}for(E=g;0<=v.l(p);){for(_=Math.max(1,Math.floor(v.m()/p.m())),I=Math.ceil(Math.log(_)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),A=d(_),y=A.j(p);k(y)||0<y.l(v);)_-=I,A=d(_),y=A.j(p);S(A)&&(A=w),E=E.add(A),v=U(v,y)}return new $(E,v)}n.A=function(v){return V(this,v).h},n.and=function(v){for(var p=Math.max(this.g.length,v.g.length),_=[],I=0;I<p;I++)_[I]=this.i(I)&v.i(I);return new a(_,this.h&v.h)},n.or=function(v){for(var p=Math.max(this.g.length,v.g.length),_=[],I=0;I<p;I++)_[I]=this.i(I)|v.i(I);return new a(_,this.h|v.h)},n.xor=function(v){for(var p=Math.max(this.g.length,v.g.length),_=[],I=0;I<p;I++)_[I]=this.i(I)^v.i(I);return new a(_,this.h^v.h)};function H(v){for(var p=v.g.length+1,_=[],I=0;I<p;I++)_[I]=v.i(I)<<1|v.i(I-1)>>>31;return new a(_,v.h)}function M(v,p){var _=p>>5;p%=32;for(var I=v.g.length-_,E=[],A=0;A<I;A++)E[A]=0<p?v.i(A+_)>>>p|v.i(A+_+1)<<32-p:v.i(A+_);return new a(E,v.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qf=$f.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,cs=$f.Integer=a}).apply(typeof jf<"u"?jf:typeof self<"u"?self:typeof window<"u"?window:{});var us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ut={};var Ka,OE,bn,Qa,xr,ls,Ja,Ya,Xa;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,c,l){return s==Array.prototype||s==Object.prototype||(s[c]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof us=="object"&&us];for(var c=0;c<s.length;++c){var l=s[c];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,c){if(c)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var T=s[f];if(!(T in l))break e;l=l[T]}s=s[s.length-1],f=l[s],c=c(f),c!=f&&c!=null&&e(l,s,{configurable:!0,writable:!0,value:c})}}function o(s,c){s instanceof String&&(s+="");var l=0,f=!1,T={next:function(){if(!f&&l<s.length){var b=l++;return{value:c(b,s[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(s){return s||function(){return o(this,function(c,l){return l})}});var a=a||{},u=this||self;function h(s){var c=typeof s;return c=c!="object"?c:s?Array.isArray(s)?"array":c:"null",c=="array"||c=="object"&&typeof s.length=="number"}function d(s){var c=typeof s;return c=="object"&&s!=null||c=="function"}function m(s,c,l){return s.call.apply(s.bind,arguments)}function g(s,c,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),s.apply(c,T)}}return function(){return s.apply(c,arguments)}}function w(s,c,l){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:g,w.apply(null,arguments)}function C(s,c){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function S(s,c){function l(){}l.prototype=c.prototype,s.aa=c.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,T,b){for(var D=Array(arguments.length-2),K=2;K<arguments.length;K++)D[K-2]=arguments[K];return c.prototype[T].apply(f,D)}}function k(s){let c=s.length;if(0<c){let l=Array(c);for(let f=0;f<c;f++)l[f]=s[f];return l}return[]}function N(s,c){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let T=s.length||0,b=f.length||0;s.length=T+b;for(let D=0;D<b;D++)s[T+D]=f[D]}else s.push(f)}}class U{constructor(c,l){this.i=c,this.j=l,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function F(s){return/^[\s\xa0]*$/.test(s)}function $(){var s=u.navigator;return s&&(s=s.userAgent)?s:""}function V(s){return V[" "](s),s}V[" "]=function(){};var H=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function M(s,c,l){for(let f in s)c.call(l,s[f],f,s)}function v(s,c){for(let l in s)c.call(void 0,s[l],l,s)}function p(s){let c={};for(let l in s)c[l]=s[l];return c}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(s,c){let l,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(l in f)s[l]=f[l];for(let b=0;b<_.length;b++)l=_[b],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var c=1;s=s.split(":");let l=[];for(;0<c&&s.length;)l.push(s.shift()),c--;return s.length&&l.push(s.join(":")),l}function A(s){u.setTimeout(()=>{throw s},0)}function y(){var s=Xs;let c=null;return s.g&&(c=s.g,s.g=s.g.next,s.g||(s.h=null),c.next=null),c}class tt{constructor(){this.h=this.g=null}add(c,l){let f=Kn.get();f.set(c,l),this.h?this.h.next=f:this.g=f,this.h=f}}var Kn=new U(()=>new Ag,s=>s.reset());class Ag{constructor(){this.next=this.g=this.h=null}set(c,l){this.h=c,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Qn,Jn=!1,Xs=new tt,il=()=>{let s=u.Promise.resolve(void 0);Qn=()=>{s.then(bg)}};var bg=()=>{for(var s;s=y();){try{s.h.call(s.g)}catch(l){A(l)}var c=Kn;c.j(s),100>c.h&&(c.h++,s.next=c.g,c.g=s)}Jn=!1};function pt(){this.s=this.s,this.C=this.C}pt.prototype.s=!1,pt.prototype.ma=function(){this.s||(this.s=!0,this.N())},pt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function fe(s,c){this.type=s,this.g=this.target=c,this.defaultPrevented=!1}fe.prototype.h=function(){this.defaultPrevented=!0};var Sg=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var s=!1,c=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};u.addEventListener("test",l,c),u.removeEventListener("test",l,c)}catch{}return s})();function Yn(s,c){if(fe.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=c,c=s.relatedTarget){if(H){e:{try{V(c.nodeName);var T=!0;break e}catch{}T=!1}T||(c=null)}}else l=="mouseover"?c=s.fromElement:l=="mouseout"&&(c=s.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:Rg[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Yn.aa.h.call(this)}}S(Yn,fe);var Rg={2:"touch",3:"pen",4:"mouse"};Yn.prototype.h=function(){Yn.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Xn="closure_listenable_"+(1e6*Math.random()|0),Pg=0;function Cg(s,c,l,f,T){this.listener=s,this.proxy=null,this.src=c,this.type=l,this.capture=!!f,this.ha=T,this.key=++Pg,this.da=this.fa=!1}function ii(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function si(s){this.src=s,this.g={},this.h=0}si.prototype.add=function(s,c,l,f,T){var b=s.toString();s=this.g[b],s||(s=this.g[b]=[],this.h++);var D=eo(s,c,f,T);return-1<D?(c=s[D],l||(c.fa=!1)):(c=new Cg(c,this.src,b,!!f,T),c.fa=l,s.push(c)),c};function Zs(s,c){var l=c.type;if(l in s.g){var f=s.g[l],T=Array.prototype.indexOf.call(f,c,void 0),b;(b=0<=T)&&Array.prototype.splice.call(f,T,1),b&&(ii(c),s.g[l].length==0&&(delete s.g[l],s.h--))}}function eo(s,c,l,f){for(var T=0;T<s.length;++T){var b=s[T];if(!b.da&&b.listener==c&&b.capture==!!l&&b.ha==f)return T}return-1}var to="closure_lm_"+(1e6*Math.random()|0),no={};function sl(s,c,l,f,T){if(f&&f.once)return al(s,c,l,f,T);if(Array.isArray(c)){for(var b=0;b<c.length;b++)sl(s,c[b],l,f,T);return null}return l=oo(l),s&&s[Xn]?s.K(c,l,d(f)?!!f.capture:!!f,T):ol(s,c,l,!1,f,T)}function ol(s,c,l,f,T,b){if(!c)throw Error("Invalid event type");var D=d(T)?!!T.capture:!!T,K=io(s);if(K||(s[to]=K=new si(s)),l=K.add(c,l,f,D,b),l.proxy)return l;if(f=kg(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)Sg||(T=D),T===void 0&&(T=!1),s.addEventListener(c.toString(),f,T);else if(s.attachEvent)s.attachEvent(ul(c.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function kg(){function s(l){return c.call(s.src,s.listener,l)}let c=Dg;return s}function al(s,c,l,f,T){if(Array.isArray(c)){for(var b=0;b<c.length;b++)al(s,c[b],l,f,T);return null}return l=oo(l),s&&s[Xn]?s.L(c,l,d(f)?!!f.capture:!!f,T):ol(s,c,l,!0,f,T)}function cl(s,c,l,f,T){if(Array.isArray(c))for(var b=0;b<c.length;b++)cl(s,c[b],l,f,T);else f=d(f)?!!f.capture:!!f,l=oo(l),s&&s[Xn]?(s=s.i,c=String(c).toString(),c in s.g&&(b=s.g[c],l=eo(b,l,f,T),-1<l&&(ii(b[l]),Array.prototype.splice.call(b,l,1),b.length==0&&(delete s.g[c],s.h--)))):s&&(s=io(s))&&(c=s.g[c.toString()],s=-1,c&&(s=eo(c,l,f,T)),(l=-1<s?c[s]:null)&&ro(l))}function ro(s){if(typeof s!="number"&&s&&!s.da){var c=s.src;if(c&&c[Xn])Zs(c.i,s);else{var l=s.type,f=s.proxy;c.removeEventListener?c.removeEventListener(l,f,s.capture):c.detachEvent?c.detachEvent(ul(l),f):c.addListener&&c.removeListener&&c.removeListener(f),(l=io(c))?(Zs(l,s),l.h==0&&(l.src=null,c[to]=null)):ii(s)}}}function ul(s){return s in no?no[s]:no[s]="on"+s}function Dg(s,c){if(s.da)s=!0;else{c=new Yn(c,this);var l=s.listener,f=s.ha||s.src;s.fa&&ro(s),s=l.call(f,c)}return s}function io(s){return s=s[to],s instanceof si?s:null}var so="__closure_events_fn_"+(1e9*Math.random()>>>0);function oo(s){return typeof s=="function"?s:(s[so]||(s[so]=function(c){return s.handleEvent(c)}),s[so])}function pe(){pt.call(this),this.i=new si(this),this.M=this,this.F=null}S(pe,pt),pe.prototype[Xn]=!0,pe.prototype.removeEventListener=function(s,c,l,f){cl(this,s,c,l,f)};function Ee(s,c){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=c.type||c,typeof c=="string")c=new fe(c,s);else if(c instanceof fe)c.target=c.target||s;else{var T=c;c=new fe(f,s),I(c,T)}if(T=!0,l)for(var b=l.length-1;0<=b;b--){var D=c.g=l[b];T=oi(D,f,!0,c)&&T}if(D=c.g=s,T=oi(D,f,!0,c)&&T,T=oi(D,f,!1,c)&&T,l)for(b=0;b<l.length;b++)D=c.g=l[b],T=oi(D,f,!1,c)&&T}pe.prototype.N=function(){if(pe.aa.N.call(this),this.i){var s=this.i,c;for(c in s.g){for(var l=s.g[c],f=0;f<l.length;f++)ii(l[f]);delete s.g[c],s.h--}}this.F=null},pe.prototype.K=function(s,c,l,f){return this.i.add(String(s),c,!1,l,f)},pe.prototype.L=function(s,c,l,f){return this.i.add(String(s),c,!0,l,f)};function oi(s,c,l,f){if(c=s.i.g[String(c)],!c)return!0;c=c.concat();for(var T=!0,b=0;b<c.length;++b){var D=c[b];if(D&&!D.da&&D.capture==l){var K=D.listener,de=D.ha||D.src;D.fa&&Zs(s.i,D),T=K.call(de,f)!==!1&&T}}return T&&!f.defaultPrevented}function ll(s,c,l){if(typeof s=="function")l&&(s=w(s,l));else if(s&&typeof s.handleEvent=="function")s=w(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:u.setTimeout(s,c||0)}function hl(s){s.g=ll(()=>{s.g=null,s.i&&(s.i=!1,hl(s))},s.l);let c=s.h;s.h=null,s.m.apply(null,c)}class Ng extends pt{constructor(c,l){super(),this.m=c,this.l=l,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:hl(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zn(s){pt.call(this),this.h=s,this.g={}}S(Zn,pt);var dl=[];function fl(s){M(s.g,function(c,l){this.g.hasOwnProperty(l)&&ro(c)},s),s.g={}}Zn.prototype.N=function(){Zn.aa.N.call(this),fl(this)},Zn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ao=u.JSON.stringify,Og=u.JSON.parse,xg=class{stringify(s){return u.JSON.stringify(s,void 0)}parse(s){return u.JSON.parse(s,void 0)}};function co(){}co.prototype.h=null;function pl(s){return s.h||(s.h=s.i())}function ml(){}var er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function uo(){fe.call(this,"d")}S(uo,fe);function lo(){fe.call(this,"c")}S(lo,fe);var xt={},gl=null;function ai(){return gl=gl||new pe}xt.La="serverreachability";function _l(s){fe.call(this,xt.La,s)}S(_l,fe);function tr(s){let c=ai();Ee(c,new _l(c))}xt.STAT_EVENT="statevent";function yl(s,c){fe.call(this,xt.STAT_EVENT,s),this.stat=c}S(yl,fe);function we(s){let c=ai();Ee(c,new yl(c,s))}xt.Ma="timingevent";function Il(s,c){fe.call(this,xt.Ma,s),this.size=c}S(Il,fe);function nr(s,c){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){s()},c)}function rr(){this.g=!0}rr.prototype.xa=function(){this.g=!1};function Vg(s,c,l,f,T,b){s.info(function(){if(s.g)if(b)for(var D="",K=b.split("&"),de=0;de<K.length;de++){var G=K[de].split("=");if(1<G.length){var me=G[0];G=G[1];var ge=me.split("_");D=2<=ge.length&&ge[1]=="type"?D+(me+"="+G+"&"):D+(me+"=redacted&")}}else D=null;else D=b;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+c+`
`+l+`
`+D})}function Lg(s,c,l,f,T,b,D){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+c+`
`+l+`
`+b+" "+D})}function hn(s,c,l,f){s.info(function(){return"XMLHTTP TEXT ("+c+"): "+Fg(s,l)+(f?" "+f:"")})}function Mg(s,c){s.info(function(){return"TIMEOUT: "+c})}rr.prototype.info=function(){};function Fg(s,c){if(!s.g)return c;if(!c)return null;try{var l=JSON.parse(c);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var b=T[0];if(b!="noop"&&b!="stop"&&b!="close")for(var D=1;D<T.length;D++)T[D]=""}}}}return ao(l)}catch{return c}}var ci={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ho;function ui(){}S(ui,co),ui.prototype.g=function(){return new XMLHttpRequest},ui.prototype.i=function(){return{}},ho=new ui;function mt(s,c,l,f){this.j=s,this.i=c,this.l=l,this.R=f||1,this.U=new Zn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new El}function El(){this.i=null,this.g="",this.h=!1}var wl={},fo={};function po(s,c,l){s.L=1,s.v=fi(nt(c)),s.m=l,s.P=!0,Tl(s,null)}function Tl(s,c){s.F=Date.now(),li(s),s.A=nt(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),Ml(l.i,"t",f),s.C=0,l=s.j.J,s.h=new El,s.g=th(s.j,l?c:null,!s.m),0<s.O&&(s.M=new Ng(w(s.Y,s,s.g),s.O)),c=s.U,l=s.g,f=s.ca;var T="readystatechange";Array.isArray(T)||(T&&(dl[0]=T.toString()),T=dl);for(var b=0;b<T.length;b++){var D=sl(l,T[b],f||c.handleEvent,!1,c.h||c);if(!D)break;c.g[D.key]=D}c=s.H?p(s.H):{},s.m?(s.u||(s.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,c)):(s.u="GET",s.g.ea(s.A,s.u,null,c)),tr(),Vg(s.i,s.u,s.A,s.l,s.R,s.m)}mt.prototype.ca=function(s){s=s.target;let c=this.M;c&&rt(s)==3?c.j():this.Y(s)},mt.prototype.Y=function(s){try{if(s==this.g)e:{let ge=rt(this.g);var c=this.g.Ba();let pn=this.g.Z();if(!(3>ge)&&(ge!=3||this.g&&(this.h.h||this.g.oa()||zl(this.g)))){this.J||ge!=4||c==7||(c==8||0>=pn?tr(3):tr(2)),mo(this);var l=this.g.Z();this.X=l;t:if(Al(this)){var f=zl(this.g);s="";var T=f.length,b=rt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vt(this),ir(this);var D="";break t}this.h.i=new u.TextDecoder}for(c=0;c<T;c++)this.h.h=!0,s+=this.h.i.decode(f[c],{stream:!(b&&c==T-1)});f.length=0,this.h.g+=s,this.C=0,D=this.h.g}else D=this.g.oa();if(this.o=l==200,Lg(this.i,this.u,this.A,this.l,this.R,ge,l),this.o){if(this.T&&!this.K){t:{if(this.g){var K,de=this.g;if((K=de.g?de.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(K)){var G=K;break t}}G=null}if(l=G)hn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,go(this,l);else{this.o=!1,this.s=3,we(12),Vt(this),ir(this);break e}}if(this.P){l=!0;let Fe;for(;!this.J&&this.C<D.length;)if(Fe=Ug(this,D),Fe==fo){ge==4&&(this.s=4,we(14),l=!1),hn(this.i,this.l,null,"[Incomplete Response]");break}else if(Fe==wl){this.s=4,we(15),hn(this.i,this.l,D,"[Invalid Chunk]"),l=!1;break}else hn(this.i,this.l,Fe,null),go(this,Fe);if(Al(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ge!=4||D.length!=0||this.h.h||(this.s=1,we(16),l=!1),this.o=this.o&&l,!l)hn(this.i,this.l,D,"[Invalid Chunked Response]"),Vt(this),ir(this);else if(0<D.length&&!this.W){this.W=!0;var me=this.j;me.g==this&&me.ba&&!me.M&&(me.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),wo(me),me.M=!0,we(11))}}else hn(this.i,this.l,D,null),go(this,D);ge==4&&Vt(this),this.o&&!this.J&&(ge==4?Yl(this.j,this):(this.o=!1,li(this)))}else n_(this.g),l==400&&0<D.indexOf("Unknown SID")?(this.s=3,we(12)):(this.s=0,we(13)),Vt(this),ir(this)}}}catch{}finally{}};function Al(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function Ug(s,c){var l=s.C,f=c.indexOf(`
`,l);return f==-1?fo:(l=Number(c.substring(l,f)),isNaN(l)?wl:(f+=1,f+l>c.length?fo:(c=c.slice(f,f+l),s.C=f+l,c)))}mt.prototype.cancel=function(){this.J=!0,Vt(this)};function li(s){s.S=Date.now()+s.I,bl(s,s.I)}function bl(s,c){if(s.B!=null)throw Error("WatchDog timer not null");s.B=nr(w(s.ba,s),c)}function mo(s){s.B&&(u.clearTimeout(s.B),s.B=null)}mt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(Mg(this.i,this.A),this.L!=2&&(tr(),we(17)),Vt(this),this.s=2,ir(this)):bl(this,this.S-s)};function ir(s){s.j.G==0||s.J||Yl(s.j,s)}function Vt(s){mo(s);var c=s.M;c&&typeof c.ma=="function"&&c.ma(),s.M=null,fl(s.U),s.g&&(c=s.g,s.g=null,c.abort(),c.ma())}function go(s,c){try{var l=s.j;if(l.G!=0&&(l.g==s||_o(l.h,s))){if(!s.K&&_o(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)yi(l),gi(l);else break e;Eo(l),we(18)}}else l.za=T[1],0<l.za-l.T&&37500>T[2]&&l.F&&l.v==0&&!l.C&&(l.C=nr(w(l.Za,l),6e3));if(1>=Pl(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else Mt(l,11)}else if((s.K||l.g==s)&&yi(l),!F(c))for(T=l.Da.g.parse(c),c=0;c<T.length;c++){let G=T[c];if(l.T=G[0],G=G[1],l.G==2)if(G[0]=="c"){l.K=G[1],l.ia=G[2];let me=G[3];me!=null&&(l.la=me,l.j.info("VER="+l.la));let ge=G[4];ge!=null&&(l.Aa=ge,l.j.info("SVER="+l.Aa));let pn=G[5];pn!=null&&typeof pn=="number"&&0<pn&&(f=1.5*pn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let Fe=s.g;if(Fe){let vi=Fe.g?Fe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vi){var b=f.h;b.g||vi.indexOf("spdy")==-1&&vi.indexOf("quic")==-1&&vi.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(yo(b,b.h),b.h=null))}if(f.D){let To=Fe.g?Fe.g.getResponseHeader("X-HTTP-Session-Id"):null;To&&(f.ya=To,J(f.I,f.D,To))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var D=s;if(f.qa=eh(f,f.J?f.ia:null,f.W),D.K){Cl(f.h,D);var K=D,de=f.L;de&&(K.I=de),K.B&&(mo(K),li(K)),f.g=D}else Ql(f);0<l.i.length&&_i(l)}else G[0]!="stop"&&G[0]!="close"||Mt(l,7);else l.G==3&&(G[0]=="stop"||G[0]=="close"?G[0]=="stop"?Mt(l,7):vo(l):G[0]!="noop"&&l.l&&l.l.ta(G),l.v=0)}}tr(4)}catch{}}var Bg=class{constructor(s,c){this.g=s,this.map=c}};function Sl(s){this.l=s||10,u.PerformanceNavigationTiming?(s=u.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Rl(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Pl(s){return s.h?1:s.g?s.g.size:0}function _o(s,c){return s.h?s.h==c:s.g?s.g.has(c):!1}function yo(s,c){s.g?s.g.add(c):s.h=c}function Cl(s,c){s.h&&s.h==c?s.h=null:s.g&&s.g.has(c)&&s.g.delete(c)}Sl.prototype.cancel=function(){if(this.i=kl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function kl(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let c=s.i;for(let l of s.g.values())c=c.concat(l.D);return c}return k(s.i)}function jg(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var c=[],l=s.length,f=0;f<l;f++)c.push(s[f]);return c}c=[],l=0;for(f in s)c[l++]=s[f];return c}function $g(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var c=[];s=s.length;for(var l=0;l<s;l++)c.push(l);return c}c=[],l=0;for(let f in s)c[l++]=f;return c}}}function Dl(s,c){if(s.forEach&&typeof s.forEach=="function")s.forEach(c,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,c,void 0);else for(var l=$g(s),f=jg(s),T=f.length,b=0;b<T;b++)c.call(void 0,f[b],l&&l[b],s)}var Nl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qg(s,c){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),T=null;if(0<=f){var b=s[l].substring(0,f);T=s[l].substring(f+1)}else b=s[l];c(b,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Lt(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof Lt){this.h=s.h,hi(this,s.j),this.o=s.o,this.g=s.g,di(this,s.s),this.l=s.l;var c=s.i,l=new ar;l.i=c.i,c.g&&(l.g=new Map(c.g),l.h=c.h),Ol(this,l),this.m=s.m}else s&&(c=String(s).match(Nl))?(this.h=!1,hi(this,c[1]||"",!0),this.o=sr(c[2]||""),this.g=sr(c[3]||"",!0),di(this,c[4]),this.l=sr(c[5]||"",!0),Ol(this,c[6]||"",!0),this.m=sr(c[7]||"")):(this.h=!1,this.i=new ar(null,this.h))}Lt.prototype.toString=function(){var s=[],c=this.j;c&&s.push(or(c,xl,!0),":");var l=this.g;return(l||c=="file")&&(s.push("//"),(c=this.o)&&s.push(or(c,xl,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(or(l,l.charAt(0)=="/"?Gg:Wg,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",or(l,Kg)),s.join("")};function nt(s){return new Lt(s)}function hi(s,c,l){s.j=l?sr(c,!0):c,s.j&&(s.j=s.j.replace(/:$/,""))}function di(s,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);s.s=c}else s.s=null}function Ol(s,c,l){c instanceof ar?(s.i=c,Qg(s.i,s.h)):(l||(c=or(c,Hg)),s.i=new ar(c,s.h))}function J(s,c,l){s.i.set(c,l)}function fi(s){return J(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function sr(s,c){return s?c?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function or(s,c,l){return typeof s=="string"?(s=encodeURI(s).replace(c,zg),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function zg(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var xl=/[#\/\?@]/g,Wg=/[#\?:]/g,Gg=/[#\?]/g,Hg=/[#\?@]/g,Kg=/#/g;function ar(s,c){this.h=this.g=null,this.i=s||null,this.j=!!c}function gt(s){s.g||(s.g=new Map,s.h=0,s.i&&qg(s.i,function(c,l){s.add(decodeURIComponent(c.replace(/\+/g," ")),l)}))}n=ar.prototype,n.add=function(s,c){gt(this),this.i=null,s=dn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(c),this.h+=1,this};function Vl(s,c){gt(s),c=dn(s,c),s.g.has(c)&&(s.i=null,s.h-=s.g.get(c).length,s.g.delete(c))}function Ll(s,c){return gt(s),c=dn(s,c),s.g.has(c)}n.forEach=function(s,c){gt(this),this.g.forEach(function(l,f){l.forEach(function(T){s.call(c,T,f,this)},this)},this)},n.na=function(){gt(this);let s=Array.from(this.g.values()),c=Array.from(this.g.keys()),l=[];for(let f=0;f<c.length;f++){let T=s[f];for(let b=0;b<T.length;b++)l.push(c[f])}return l},n.V=function(s){gt(this);let c=[];if(typeof s=="string")Ll(this,s)&&(c=c.concat(this.g.get(dn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)c=c.concat(s[l])}return c},n.set=function(s,c){return gt(this),this.i=null,s=dn(this,s),Ll(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[c]),this.h+=1,this},n.get=function(s,c){return s?(s=this.V(s),0<s.length?String(s[0]):c):c};function Ml(s,c,l){Vl(s,c),0<l.length&&(s.i=null,s.g.set(dn(s,c),k(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],c=Array.from(this.g.keys());for(var l=0;l<c.length;l++){var f=c[l];let b=encodeURIComponent(String(f)),D=this.V(f);for(f=0;f<D.length;f++){var T=b;D[f]!==""&&(T+="="+encodeURIComponent(String(D[f]))),s.push(T)}}return this.i=s.join("&")};function dn(s,c){return c=String(c),s.j&&(c=c.toLowerCase()),c}function Qg(s,c){c&&!s.j&&(gt(s),s.i=null,s.g.forEach(function(l,f){var T=f.toLowerCase();f!=T&&(Vl(this,f),Ml(this,T,l))},s)),s.j=c}function Jg(s,c){let l=new rr;if(u.Image){let f=new Image;f.onload=C(_t,l,"TestLoadImage: loaded",!0,c,f),f.onerror=C(_t,l,"TestLoadImage: error",!1,c,f),f.onabort=C(_t,l,"TestLoadImage: abort",!1,c,f),f.ontimeout=C(_t,l,"TestLoadImage: timeout",!1,c,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else c(!1)}function Yg(s,c){let l=new rr,f=new AbortController,T=setTimeout(()=>{f.abort(),_t(l,"TestPingServer: timeout",!1,c)},1e4);fetch(s,{signal:f.signal}).then(b=>{clearTimeout(T),b.ok?_t(l,"TestPingServer: ok",!0,c):_t(l,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(T),_t(l,"TestPingServer: error",!1,c)})}function _t(s,c,l,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(l)}catch{}}function Xg(){this.g=new xg}function Zg(s,c,l){let f=l||"";try{Dl(s,function(T,b){let D=T;d(T)&&(D=ao(T)),c.push(f+b+"="+encodeURIComponent(D))})}catch(T){throw c.push(f+"type="+encodeURIComponent("_badmap")),T}}function cr(s){this.l=s.Ub||null,this.j=s.eb||!1}S(cr,co),cr.prototype.g=function(){return new pi(this.l,this.j)},cr.prototype.i=(function(s){return function(){return s}})({});function pi(s,c){pe.call(this),this.D=s,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(pi,pe),n=pi.prototype,n.open=function(s,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=c,this.readyState=1,lr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(c.body=s),(this.D||u).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ur(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,lr(this)),this.g&&(this.readyState=3,lr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fl(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fl(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var c=s.value?s.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!s.done}))&&(this.response=this.responseText+=c)}s.done?ur(this):lr(this),this.readyState==3&&Fl(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,ur(this))},n.Qa=function(s){this.g&&(this.response=s,ur(this))},n.ga=function(){this.g&&ur(this)};function ur(s){s.readyState=4,s.l=null,s.j=null,s.v=null,lr(s)}n.setRequestHeader=function(s,c){this.u.append(s,c)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],c=this.h.entries();for(var l=c.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=c.next();return s.join(`\r
`)};function lr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Ul(s){let c="";return M(s,function(l,f){c+=f,c+=":",c+=l,c+=`\r
`}),c}function Io(s,c,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Ul(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):J(s,c,l))}function Y(s){pe.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Y,pe);var e_=/^https?$/i,t_=["POST","PUT"];n=Y.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,c,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);c=c?c.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ho.g(),this.v=this.o?pl(this.o):pl(ho),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(c,String(s),!0),this.B=!1}catch(b){Bl(this,b);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)l.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())l.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(b=>b.toLowerCase()=="content-type"),T=u.FormData&&s instanceof u.FormData,!(0<=Array.prototype.indexOf.call(t_,c,void 0))||f||T||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,D]of l)this.g.setRequestHeader(b,D);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ql(this),this.u=!0,this.g.send(s),this.u=!1}catch(b){Bl(this,b)}};function Bl(s,c){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=c,s.m=5,jl(s),mi(s)}function jl(s){s.A||(s.A=!0,Ee(s,"complete"),Ee(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Ee(this,"complete"),Ee(this,"abort"),mi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mi(this,!0)),Y.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?$l(this):this.bb())},n.bb=function(){$l(this)};function $l(s){if(s.h&&typeof a<"u"&&(!s.v[1]||rt(s)!=4||s.Z()!=2)){if(s.u&&rt(s)==4)ll(s.Ea,0,s);else if(Ee(s,"readystatechange"),rt(s)==4){s.h=!1;try{let D=s.Z();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var l;if(!(l=c)){var f;if(f=D===0){var T=String(s.D).match(Nl)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!e_.test(T?T.toLowerCase():"")}l=f}if(l)Ee(s,"complete"),Ee(s,"success");else{s.m=6;try{var b=2<rt(s)?s.g.statusText:""}catch{b=""}s.l=b+" ["+s.Z()+"]",jl(s)}}finally{mi(s)}}}}function mi(s,c){if(s.g){ql(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,c||Ee(s,"ready");try{l.onreadystatechange=f}catch{}}}function ql(s){s.I&&(u.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function rt(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<rt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var c=this.g.responseText;return s&&c.indexOf(s)==0&&(c=c.substring(s.length)),Og(c)}};function zl(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function n_(s){let c={};s=(s.g&&2<=rt(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(F(s[f]))continue;var l=E(s[f]);let T=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let b=c[T]||[];c[T]=b,b.push(l)}v(c,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hr(s,c,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||c}function Wl(s){this.Aa=0,this.i=[],this.j=new rr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hr("baseRetryDelayMs",5e3,s),this.cb=hr("retryDelaySeedMs",1e4,s),this.Wa=hr("forwardChannelMaxRetries",2,s),this.wa=hr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Sl(s&&s.concurrentRequestLimit),this.Da=new Xg,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Wl.prototype,n.la=8,n.G=1,n.connect=function(s,c,l,f){we(0),this.W=s,this.H=c||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=eh(this,null,this.W),_i(this)};function vo(s){if(Gl(s),s.G==3){var c=s.U++,l=nt(s.I);if(J(l,"SID",s.K),J(l,"RID",c),J(l,"TYPE","terminate"),dr(s,l),c=new mt(s,s.j,c),c.L=2,c.v=fi(nt(l)),l=!1,u.navigator&&u.navigator.sendBeacon)try{l=u.navigator.sendBeacon(c.v.toString(),"")}catch{}!l&&u.Image&&(new Image().src=c.v,l=!0),l||(c.g=th(c.j,null),c.g.ea(c.v)),c.F=Date.now(),li(c)}Zl(s)}function gi(s){s.g&&(wo(s),s.g.cancel(),s.g=null)}function Gl(s){gi(s),s.u&&(u.clearTimeout(s.u),s.u=null),yi(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&u.clearTimeout(s.s),s.s=null)}function _i(s){if(!Rl(s.h)&&!s.s){s.s=!0;var c=s.Ga;Qn||il(),Jn||(Qn(),Jn=!0),Xs.add(c,s),s.B=0}}function r_(s,c){return Pl(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=c.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=nr(w(s.Ga,s,c),Xl(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let T=new mt(this,this.j,s),b=this.o;if(this.S&&(b?(b=p(b),I(b,this.S)):b=this.S),this.m!==null||this.O||(T.H=b,b=null),this.P)e:{for(var c=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=l;break e}if(c===4096||l===this.i.length-1){c=l+1;break e}}c=1e3}else c=1e3;c=Kl(this,T,c),l=nt(this.I),J(l,"RID",s),J(l,"CVER",22),this.D&&J(l,"X-HTTP-Session-Id",this.D),dr(this,l),b&&(this.O?c="headers="+encodeURIComponent(String(Ul(b)))+"&"+c:this.m&&Io(l,this.m,b)),yo(this.h,T),this.Ua&&J(l,"TYPE","init"),this.P?(J(l,"$req",c),J(l,"SID","null"),T.T=!0,po(T,l,null)):po(T,l,c),this.G=2}}else this.G==3&&(s?Hl(this,s):this.i.length==0||Rl(this.h)||Hl(this))};function Hl(s,c){var l;c?l=c.l:l=s.U++;let f=nt(s.I);J(f,"SID",s.K),J(f,"RID",l),J(f,"AID",s.T),dr(s,f),s.m&&s.o&&Io(f,s.m,s.o),l=new mt(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),c&&(s.i=c.D.concat(s.i)),c=Kl(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),yo(s.h,l),po(l,f,c)}function dr(s,c){s.H&&M(s.H,function(l,f){J(c,f,l)}),s.l&&Dl({},function(l,f){J(c,f,l)})}function Kl(s,c,l){l=Math.min(s.i.length,l);var f=s.l?w(s.l.Na,s.l,s):null;e:{var T=s.i;let b=-1;for(;;){let D=["count="+l];b==-1?0<l?(b=T[0].g,D.push("ofs="+b)):b=0:D.push("ofs="+b);let K=!0;for(let de=0;de<l;de++){let G=T[de].g,me=T[de].map;if(G-=b,0>G)b=Math.max(0,T[de].g-100),K=!1;else try{Zg(me,D,"req"+G+"_")}catch{f&&f(me)}}if(K){f=D.join("&");break e}}}return s=s.i.splice(0,l),c.D=s,f}function Ql(s){if(!s.g&&!s.u){s.Y=1;var c=s.Fa;Qn||il(),Jn||(Qn(),Jn=!0),Xs.add(c,s),s.v=0}}function Eo(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=nr(w(s.Fa,s),Xl(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Jl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=nr(w(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,we(10),gi(this),Jl(this))};function wo(s){s.A!=null&&(u.clearTimeout(s.A),s.A=null)}function Jl(s){s.g=new mt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var c=nt(s.qa);J(c,"RID","rpc"),J(c,"SID",s.K),J(c,"AID",s.T),J(c,"CI",s.F?"0":"1"),!s.F&&s.ja&&J(c,"TO",s.ja),J(c,"TYPE","xmlhttp"),dr(s,c),s.m&&s.o&&Io(c,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=fi(nt(c)),l.m=null,l.P=!0,Tl(l,s)}n.Za=function(){this.C!=null&&(this.C=null,gi(this),Eo(this),we(19))};function yi(s){s.C!=null&&(u.clearTimeout(s.C),s.C=null)}function Yl(s,c){var l=null;if(s.g==c){yi(s),wo(s),s.g=null;var f=2}else if(_o(s.h,c))l=c.D,Cl(s.h,c),f=1;else return;if(s.G!=0){if(c.o)if(f==1){l=c.m?c.m.length:0,c=Date.now()-c.F;var T=s.B;f=ai(),Ee(f,new Il(f,l)),_i(s)}else Ql(s);else if(T=c.s,T==3||T==0&&0<c.X||!(f==1&&r_(s,c)||f==2&&Eo(s)))switch(l&&0<l.length&&(c=s.h,c.i=c.i.concat(l)),T){case 1:Mt(s,5);break;case 4:Mt(s,10);break;case 3:Mt(s,6);break;default:Mt(s,2)}}}function Xl(s,c){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*c}function Mt(s,c){if(s.j.info("Error code "+c),c==2){var l=w(s.fb,s),f=s.Xa;let T=!f;f=new Lt(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||hi(f,"https"),fi(f),T?Jg(f.toString(),l):Yg(f.toString(),l)}else we(2);s.G=0,s.l&&s.l.sa(c),Zl(s),Gl(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),we(2)):(this.j.info("Failed to ping google.com"),we(1))};function Zl(s){if(s.G=0,s.ka=[],s.l){let c=kl(s.h);(c.length!=0||s.i.length!=0)&&(N(s.ka,c),N(s.ka,s.i),s.h.i.length=0,k(s.i),s.i.length=0),s.l.ra()}}function eh(s,c,l){var f=l instanceof Lt?nt(l):new Lt(l);if(f.g!="")c&&(f.g=c+"."+f.g),di(f,f.s);else{var T=u.location;f=T.protocol,c=c?c+"."+T.hostname:T.hostname,T=+T.port;var b=new Lt(null);f&&hi(b,f),c&&(b.g=c),T&&di(b,T),l&&(b.l=l),f=b}return l=s.D,c=s.ya,l&&c&&J(f,l,c),J(f,"VER",s.la),dr(s,f),f}function th(s,c,l){if(c&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=s.Ca&&!s.pa?new Y(new cr({eb:l})):new Y(s.pa),c.Ha(s.J),c}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function nh(){}n=nh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ii(){}Ii.prototype.g=function(s,c){return new Re(s,c)};function Re(s,c){pe.call(this),this.g=new Wl(c),this.l=s,this.h=c&&c.messageUrlParams||null,s=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(s?s["X-WebChannel-Content-Type"]=c.messageContentType:s={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(s?s["X-WebChannel-Client-Profile"]=c.va:s={"X-WebChannel-Client-Profile":c.va}),this.g.S=s,(s=c&&c.Sb)&&!F(s)&&(this.g.m=s),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!F(c)&&(this.g.D=c,s=this.h,s!==null&&c in s&&(s=this.h,c in s&&delete s[c])),this.j=new fn(this)}S(Re,pe),Re.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Re.prototype.close=function(){vo(this.g)},Re.prototype.o=function(s){var c=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=ao(s),s=l);c.i.push(new Bg(c.Ya++,s)),c.G==3&&_i(c)},Re.prototype.N=function(){this.g.l=null,delete this.j,vo(this.g),delete this.g,Re.aa.N.call(this)};function rh(s){uo.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var c=s.__sm__;if(c){e:{for(let l in c){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,c=c!==null&&s in c?c[s]:void 0),this.data=c}else this.data=s}S(rh,uo);function ih(){lo.call(this),this.status=1}S(ih,lo);function fn(s){this.g=s}S(fn,nh),fn.prototype.ua=function(){Ee(this.g,"a")},fn.prototype.ta=function(s){Ee(this.g,new rh(s))},fn.prototype.sa=function(s){Ee(this.g,new ih)},fn.prototype.ra=function(){Ee(this.g,"b")},Ii.prototype.createWebChannel=Ii.prototype.g,Re.prototype.send=Re.prototype.o,Re.prototype.open=Re.prototype.m,Re.prototype.close=Re.prototype.close,Xa=ut.createWebChannelTransport=function(){return new Ii},Ya=ut.getStatEventTarget=function(){return ai()},Ja=ut.Event=xt,ls=ut.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ci.NO_ERROR=0,ci.TIMEOUT=8,ci.HTTP_ERROR=6,xr=ut.ErrorCode=ci,vl.COMPLETE="complete",Qa=ut.EventType=vl,ml.EventType=er,er.OPEN="a",er.CLOSE="b",er.ERROR="c",er.MESSAGE="d",pe.prototype.listen=pe.prototype.K,bn=ut.WebChannel=ml,OE=ut.FetchXmlHttpFactory=cr,Y.prototype.listenOnce=Y.prototype.L,Y.prototype.getLastError=Y.prototype.Ka,Y.prototype.getLastErrorCode=Y.prototype.Ba,Y.prototype.getStatus=Y.prototype.Z,Y.prototype.getResponseJson=Y.prototype.Oa,Y.prototype.getResponseText=Y.prototype.oa,Y.prototype.send=Y.prototype.ea,Y.prototype.setWithCredentials=Y.prototype.Ha,Ka=ut.XhrIo=Y}).apply(typeof us<"u"?us:typeof self<"u"?self:typeof window<"u"?window:{});var zf="@firebase/firestore",Wf="4.8.0";var le=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};le.UNAUTHENTICATED=new le(null),le.GOOGLE_CREDENTIALS=new le("google-credentials-uid"),le.FIRST_PARTY=new le("first-party-uid"),le.MOCK_USER=new le("mock-user");var Wn="11.10.0";var tn=new He("@firebase/firestore");function Sn(){return tn.logLevel}function O(n,...e){if(tn.logLevel<=q.DEBUG){let t=e.map(Su);tn.debug(`Firestore (${Wn}): ${n}`,...t)}}function nn(n,...e){if(tn.logLevel<=q.ERROR){let t=e.map(Su);tn.error(`Firestore (${Wn}): ${n}`,...t)}}function On(n,...e){if(tn.logLevel<=q.WARN){let t=e.map(Su);tn.warn(`Firestore (${Wn}): ${n}`,...t)}}function Su(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function B(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,bp(n,r,t)}function bp(n,e,t){let r=`FIRESTORE (${Wn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw nn(r),new Error(r)}function ee(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||bp(e,i,r)}function Q(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends ke{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var lt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var _s=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},nc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(le.UNAUTHENTICATED))}shutdown(){}},rc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},ic=class{constructor(e){this.t=e,this.currentUser=le.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0,42304);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new lt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new lt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?u(h):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new lt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string",31837,{l:r}),new _s(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string",2055,{h:e}),new le(e)}},sc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=le.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},oc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new sc(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(le.FIRST_PARTY))}shutdown(){}invalidateToken(){}},ys=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ac=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Se(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ee(this.o===void 0,3512);let r=o=>{o.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.m;return this.m=o.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ys(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ee(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ys(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function xE(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function VE(){return new TextEncoder}var jr=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=xE(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function W(n,e){return n<e?-1:n>e?1:0}function cc(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return W(r,i);{let o=VE(),a=LE(o.encode(Gf(n,t)),o.encode(Gf(e,t)));return a!==0?a:W(r,i)}}t+=r>65535?2:1}return W(n.length,e.length)}function Gf(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function LE(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return W(n[t],e[t]);return W(n.length,e.length)}function xn(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Hf="__name__",Is=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&B(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&B(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return W(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):cc(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return cs.fromString(e.substring(4,e.length-2))}},ae=class n extends Is{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},ME=/^[_a-zA-Z][_a-zA-Z0-9]*$/,De=class n extends Is{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return ME.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Hf}static keyField(){return new n([Hf])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new x(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new x(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new x(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(o(),i++)}if(o(),a)throw new x(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var j=class n{constructor(e){this.path=e}static fromPath(e){return new n(ae.fromString(e))}static fromName(e){return new n(ae.fromString(e).popFirst(5))}static empty(){return new n(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ae(e.slice()))}};function FE(n,e,t){if(!t)throw new x(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function UE(n,e,t,r){if(e===!0&&r===!0)throw new x(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Kf(n){if(!j.isDocumentKey(n))throw new x(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Sp(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ru(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":B(12329,{type:typeof n})}function uc(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ru(n);throw new x(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function se(n,e){let t={typeString:n};return e&&(t.value=e),t}function Yr(n,e){if(!Sp(n))throw new x(R.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&a!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new x(R.INVALID_ARGUMENT,t);return!0}var Qf=-62135596800,Jf=1e6,ce=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Jf);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Qf)throw new x(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Jf}_compareTo(e){return this.seconds===e.seconds?W(this.nanoseconds,e.nanoseconds):W(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yr(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Qf;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ce._jsonSchemaVersion="firestore/timestamp/1.0",ce._jsonSchema={type:se("string",ce._jsonSchemaVersion),seconds:se("number"),nanoseconds:se("number")};var Z=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ce(0,0))}static max(){return new n(new ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var $r=-1,lc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};lc.UNKNOWN_ID=-1;function BE(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Z.fromTimestamp(r===1e9?new ce(t+1,0):new ce(t,r));return new rn(i,j.empty(),e)}function jE(n){return new rn(n.readTime,n.key,$r)}var rn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Z.min(),j.empty(),$r)}static max(){return new n(Z.max(),j.empty(),$r)}};function $E(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:W(n.largestBatchId,e.largestBatchId))}var qE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",hc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Pu(n){if(n.code!==R.FAILED_PRECONDITION||n.message!==qE)throw n;O("LocalStore","Unexpectedly lost primary lease")}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&B(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),u=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(m=>{a[d]=m,++u,u===o&&r(a)},m=>i(m))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function zE(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Xr(n){return n.name==="IndexedDbTransactionError"}var Rp=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),Cu=-1;function ku(n){return n==null}function qr(n){return n===0&&1/n==-1/0}function WE(n){return typeof n=="number"&&Number.isInteger(n)&&!qr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Pp="";function GE(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Yf(e)),e=HE(n.get(t),e);return Yf(e)}function HE(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case Pp:t+="";break;default:t+=o}}return t}function Yf(n){return n+Pp+""}var KE="remoteDocuments",Cp="owner";var kp="mutationQueues";var Dp="mutations";var Np="documentMutations",QE="remoteDocumentsV14";var Op="remoteDocumentGlobal";var xp="targets";var Vp="targetDocuments";var Lp="targetGlobal",Mp="collectionParents";var Fp="clientMetadata";var Up="bundles";var Bp="namedQueries";var JE="indexConfiguration";var YE="indexState";var XE="indexEntries";var jp="documentOverlays";var ZE="globals";var ew=[kp,Dp,Np,KE,xp,Cp,Lp,Vp,Fp,Op,Mp,Up,Bp],CS=[...ew,jp],tw=[kp,Dp,Np,QE,xp,Cp,Lp,Vp,Fp,Op,Mp,Up,Bp,jp],nw=tw,rw=[...nw,JE,YE,XE];var kS=[...rw,ZE];function Xf(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $p(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Oe=class n{constructor(e,t){this.comparator=e,this.root=t||Ze.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pn(this.root,e,this.comparator,!0)}},Pn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ze=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw B(43730,{key:this.key,value:this.value});if(this.right.isRed())throw B(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw B(27949);return e+(this.isRed()?0:1)}};Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1;Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw B(57766)}get value(){throw B(16141)}get color(){throw B(16727)}get left(){throw B(29726)}get right(){throw B(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new Ze(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ve=class n{constructor(e){this.comparator=e,this.data=new Oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vs(this.data.getIterator())}getIteratorFrom(e){return new vs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},vs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Xe=class n{constructor(e){this.fields=e,e.sort(De.comparator)}static empty(){return new n([])}unionWith(e){let t=new ve(De.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xn(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var dc=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ht=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new dc("Invalid base64 string: "+o):o}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return W(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ht.EMPTY_BYTE_STRING=new ht("");var iw=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kt(n){if(ee(!!n,39018),typeof n=="string"){let e=0,t=iw.exec(n);if(ee(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ie(n.seconds),nanos:ie(n.nanos)}}function ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function sn(n){return typeof n=="string"?ht.fromBase64String(n):ht.fromUint8Array(n)}var qp="server_timestamp",zp="__type__",Wp="__previous_value__",Gp="__local_write_time__";function Du(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[zp])===null||t===void 0?void 0:t.stringValue)===qp}function Nu(n){let e=n.mapValue.fields[Wp];return Du(e)?Nu(e):e}function Es(n){let e=kt(n.mapValue.fields[Gp].timestampValue);return new ce(e.seconds,e.nanos)}var fc=class{constructor(e,t,r,i,o,a,u,h,d,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=m}},ws="(default)",pc=class n{constructor(e,t){this.projectId=e,this.database=t||ws}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===ws}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ou="__type__",Hp="__max__",hs={mapValue:{fields:{__type__:{stringValue:Hp}}}},xu="__vector__",zr="value";function on(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Du(n)?4:Qp(n)?9007199254740991:Kp(n)?10:11:B(28295,{value:n})}function et(n,e){if(n===e)return!0;let t=on(n);if(t!==on(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Es(n).isEqual(Es(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=kt(i.timestampValue),u=kt(o.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return sn(i.bytesValue).isEqual(sn(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return ie(i.geoPointValue.latitude)===ie(o.geoPointValue.latitude)&&ie(i.geoPointValue.longitude)===ie(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return ie(i.integerValue)===ie(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ie(i.doubleValue),u=ie(o.doubleValue);return a===u?qr(a)===qr(u):isNaN(a)&&isNaN(u)}return!1})(n,e);case 9:return xn(n.arrayValue.values||[],e.arrayValue.values||[],et);case 10:case 11:return(function(i,o){let a=i.mapValue.fields||{},u=o.mapValue.fields||{};if(Xf(a)!==Xf(u))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(u[h]===void 0||!et(a[h],u[h])))return!1;return!0})(n,e);default:return B(52216,{left:n})}}function Wr(n,e){return(n.values||[]).find(t=>et(t,e))!==void 0}function Vn(n,e){if(n===e)return 0;let t=on(n),r=on(e);if(t!==r)return W(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return W(n.booleanValue,e.booleanValue);case 2:return(function(o,a){let u=ie(o.integerValue||o.doubleValue),h=ie(a.integerValue||a.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,e);case 3:return Zf(n.timestampValue,e.timestampValue);case 4:return Zf(Es(n),Es(e));case 5:return cc(n.stringValue,e.stringValue);case 6:return(function(o,a){let u=sn(o),h=sn(a);return u.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,a){let u=o.split("/"),h=a.split("/");for(let d=0;d<u.length&&d<h.length;d++){let m=W(u[d],h[d]);if(m!==0)return m}return W(u.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,a){let u=W(ie(o.latitude),ie(a.latitude));return u!==0?u:W(ie(o.longitude),ie(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return ep(n.arrayValue,e.arrayValue);case 10:return(function(o,a){var u,h,d,m;let g=o.fields||{},w=a.fields||{},C=(u=g[zr])===null||u===void 0?void 0:u.arrayValue,S=(h=w[zr])===null||h===void 0?void 0:h.arrayValue,k=W(((d=C?.values)===null||d===void 0?void 0:d.length)||0,((m=S?.values)===null||m===void 0?void 0:m.length)||0);return k!==0?k:ep(C,S)})(n.mapValue,e.mapValue);case 11:return(function(o,a){if(o===hs.mapValue&&a===hs.mapValue)return 0;if(o===hs.mapValue)return 1;if(a===hs.mapValue)return-1;let u=o.fields||{},h=Object.keys(u),d=a.fields||{},m=Object.keys(d);h.sort(),m.sort();for(let g=0;g<h.length&&g<m.length;++g){let w=cc(h[g],m[g]);if(w!==0)return w;let C=Vn(u[h[g]],d[m[g]]);if(C!==0)return C}return W(h.length,m.length)})(n.mapValue,e.mapValue);default:throw B(23264,{le:t})}}function Zf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return W(n,e);let t=kt(n),r=kt(e),i=W(t.seconds,r.seconds);return i!==0?i:W(t.nanos,r.nanos)}function ep(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Vn(t[i],r[i]);if(o)return o}return W(t.length,r.length)}function Ln(n){return mc(n)}function mc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=kt(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return sn(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return j.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=mc(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${mc(t.fields[a])}`;return i+"}"})(n.mapValue):B(61005,{value:n})}function ps(n){switch(on(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Nu(n);return e?16+ps(e):16;case 5:return 2*n.stringValue.length;case 6:return sn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,o)=>i+ps(o),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Gn(r.fields,(o,a)=>{i+=o.length+ps(a)}),i})(n.mapValue);default:throw B(13486,{value:n})}}function gc(n){return!!n&&"integerValue"in n}function Vu(n){return!!n&&"arrayValue"in n}function ms(n){return!!n&&"mapValue"in n}function Kp(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Ou])===null||t===void 0?void 0:t.stringValue)===xu}function Lr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Gn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Lr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Lr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Qp(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Hp}var NS={mapValue:{fields:{[Ou]:{stringValue:xu},[zr]:{arrayValue:{}}}}};var Ye=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ms(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lr(t)}setAll(e){let t=De.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=Lr(a):i.push(u.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());ms(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return et(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ms(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Gn(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Lr(this.value))}};function Jp(n){let e=[];return Gn(n.fields,(t,r)=>{let i=new De([t]);if(ms(r)){let o=Jp(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Xe(e)}var Mn=class n{constructor(e,t,r,i,o,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,Z.min(),Z.min(),Z.min(),Ye.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Z.min(),Z.min(),Ye.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Z.min(),Z.min(),Ye.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ye.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ye.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Fn=class{constructor(e,t){this.position=e,this.inclusive=t}};function tp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=j.comparator(j.fromName(a.referenceValue),t.key):r=Vn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function np(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!et(n.position[t],e.position[t]))return!1;return!0}var Un=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function sw(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ts=class{},he=class n extends Ts{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new yc(e,t,r):t==="array-contains"?new Ec(e,r):t==="in"?new wc(e,r):t==="not-in"?new Tc(e,r):t==="array-contains-any"?new Ac(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Ic(e,r):new vc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vn(t,this.value)):t!==null&&on(this.value)===on(t)&&this.matchesComparison(Vn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return B(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Dt=class n extends Ts{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return Yp(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function Yp(n){return n.op==="and"}function Xp(n){return ow(n)&&Yp(n)}function ow(n){for(let e of n.filters)if(e instanceof Dt)return!1;return!0}function _c(n){if(n instanceof he)return n.field.canonicalString()+n.op.toString()+Ln(n.value);if(Xp(n))return n.filters.map(e=>_c(e)).join(",");{let e=n.filters.map(t=>_c(t)).join(",");return`${n.op}(${e})`}}function Zp(n,e){return n instanceof he?(function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&et(r.value,i.value)})(n,e):n instanceof Dt?(function(r,i){return i instanceof Dt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,u)=>o&&Zp(a,i.filters[u]),!0):!1})(n,e):void B(19439)}function em(n){return n instanceof he?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ln(t.value)}`})(n):n instanceof Dt?(function(t){return t.op.toString()+" {"+t.getFilters().map(em).join(" ,")+"}"})(n):"Filter"}var yc=class extends he{constructor(e,t,r){super(e,t,r),this.key=j.fromName(r.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},Ic=class extends he{constructor(e,t){super(e,"in",t),this.keys=tm("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},vc=class extends he{constructor(e,t){super(e,"not-in",t),this.keys=tm("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function tm(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>j.fromName(r.referenceValue))}var Ec=class extends he{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Vu(t)&&Wr(t.arrayValue,this.value)}},wc=class extends he{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Wr(this.value.arrayValue,t)}},Tc=class extends he{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wr(this.value.arrayValue,t)}},Ac=class extends he{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Vu(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Wr(this.value.arrayValue,r))}};var bc=class{constructor(e,t=null,r=[],i=[],o=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=u,this.Pe=null}};function rp(n,e=null,t=[],r=[],i=null,o=null,a=null){return new bc(n,e,t,r,i,o,a)}function Lu(n){let e=Q(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>_c(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(o){return o.field.canonicalString()+o.dir})(r)).join(","),ku(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ln(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ln(r)).join(",")),e.Pe=t}return e.Pe}function Mu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!sw(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Zp(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!np(n.startAt,e.startAt)&&np(n.endAt,e.endAt)}var Bn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=u,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function aw(n,e,t,r,i,o,a,u){return new Bn(n,e,t,r,i,o,a,u)}function cw(n){return new Bn(n)}function ip(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function uw(n){return n.collectionGroup!==null}function Mr(n){let e=Q(n);if(e.Te===null){e.Te=[];let t=new Set;for(let o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new ve(De.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new Un(o,r))}),t.has(De.keyField().canonicalString())||e.Te.push(new Un(De.keyField(),r))}return e.Te}function Jt(n){let e=Q(n);return e.Ie||(e.Ie=lw(e,Mr(n))),e.Ie}function lw(n,e){if(n.limitType==="F")return rp(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Un(i.field,o)});let t=n.endAt?new Fn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Fn(n.startAt.position,n.startAt.inclusive):null;return rp(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Sc(n,e,t){return new Bn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function nm(n,e){return Mu(Jt(n),Jt(e))&&n.limitType===e.limitType}function rm(n){return`${Lu(Jt(n))}|lt:${n.limitType}`}function Vr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>em(i)).join(", ")}]`),ku(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ln(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ln(i)).join(",")),`Target(${r})`})(Jt(n))}; limitType=${n.limitType})`}function Fu(n,e){return e.isFoundDocument()&&(function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):j.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(let o of Mr(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,u,h){let d=tp(a,u,h);return a.inclusive?d<=0:d<0})(r.startAt,Mr(r),i)||r.endAt&&!(function(a,u,h){let d=tp(a,u,h);return a.inclusive?d>=0:d>0})(r.endAt,Mr(r),i))})(n,e)}function hw(n){return(e,t)=>{let r=!1;for(let i of Mr(n)){let o=dw(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function dw(n,e,t){let r=n.field.isKeyField()?j.comparator(e.key,t.key):(function(o,a,u){let h=a.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Vn(h,d):B(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return B(19790,{direction:n.dir})}}var dt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gn(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return $p(this.inner)}size(){return this.innerSize}};var fw=new Oe(j.comparator);function As(){return fw}var im=new Oe(j.comparator);function ds(...n){let e=im;for(let t of n)e=e.insert(t.key,t);return e}function sm(n){let e=im;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Qt(){return Fr()}function om(){return Fr()}function Fr(){return new dt(n=>n.toString(),(n,e)=>n.isEqual(e))}var pw=new Oe(j.comparator),mw=new ve(j.comparator);function Ie(...n){let e=mw;for(let t of n)e=e.add(t);return e}var gw=new ve(W);function _w(){return gw}function Uu(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qr(e)?"-0":e}}function am(n){return{integerValue:""+n}}function yw(n,e){return WE(e)?am(e):Uu(n,e)}var jn=class{constructor(){this._=void 0}};function Iw(n,e,t){return n instanceof $n?(function(i,o){let a={fields:{[zp]:{stringValue:qp},[Gp]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Du(o)&&(o=Nu(o)),o&&(a.fields[Wp]=o),{mapValue:a}})(t,e):n instanceof an?um(n,e):n instanceof cn?lm(n,e):(function(i,o){let a=cm(i,o),u=sp(a)+sp(i.Ee);return gc(a)&&gc(i.Ee)?am(u):Uu(i.serializer,u)})(n,e)}function vw(n,e,t){return n instanceof an?um(n,e):n instanceof cn?lm(n,e):t}function cm(n,e){return n instanceof qn?(function(r){return gc(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}var $n=class extends jn{},an=class extends jn{constructor(e){super(),this.elements=e}};function um(n,e){let t=hm(e);for(let r of n.elements)t.some(i=>et(i,r))||t.push(r);return{arrayValue:{values:t}}}var cn=class extends jn{constructor(e){super(),this.elements=e}};function lm(n,e){let t=hm(e);for(let r of n.elements)t=t.filter(i=>!et(i,r));return{arrayValue:{values:t}}}var qn=class extends jn{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function sp(n){return ie(n.integerValue||n.doubleValue)}function hm(n){return Vu(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Ew(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof an&&i instanceof an||r instanceof cn&&i instanceof cn?xn(r.elements,i.elements,et):r instanceof qn&&i instanceof qn?et(r.Ee,i.Ee):r instanceof $n&&i instanceof $n})(n.transform,e.transform)}var Rc=class{constructor(e,t){this.version=e,this.transformResults=t}},Yt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function gs(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var zn=class{};function dm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new bs(n.key,Yt.none()):new un(n.key,n.data,Yt.none());{let t=n.data,r=Ye.empty(),i=new ve(De.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new ft(n.key,r,new Xe(i.toArray()),Yt.none())}}function ww(n,e,t){n instanceof un?(function(i,o,a){let u=i.value.clone(),h=ap(i.fieldTransforms,o,a.transformResults);u.setAll(h),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()})(n,e,t):n instanceof ft?(function(i,o,a){if(!gs(i.precondition,o))return void o.convertToUnknownDocument(a.version);let u=ap(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(fm(i)),h.setAll(u),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()})(n,e,t):(function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Ur(n,e,t,r){return n instanceof un?(function(o,a,u,h){if(!gs(o.precondition,a))return u;let d=o.value.clone(),m=cp(o.fieldTransforms,h,a);return d.setAll(m),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof ft?(function(o,a,u,h){if(!gs(o.precondition,a))return u;let d=cp(o.fieldTransforms,h,a),m=a.data;return m.setAll(fm(o)),m.setAll(d),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(g=>g.field))})(n,e,t,r):(function(o,a,u){return gs(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u})(n,e,t)}function Tw(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=cm(r.transform,i||null);o!=null&&(t===null&&(t=Ye.empty()),t.set(r.field,o))}return t||null}function op(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&xn(r,i,(o,a)=>Ew(o,a))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var un=class extends zn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ft=class extends zn{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function fm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function ap(n,e,t){let r=new Map;ee(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,u=e.data.field(o.field);r.set(o.field,vw(a,u,t[i]))}return r}function cp(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,Iw(o,a,e))}return r}var bs=class extends zn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Pc=class extends zn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Cc=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&ww(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ur(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ur(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=om();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,u=this.applyToLocalView(a,o.mutatedFields);u=t.has(i.key)?null:u;let h=dm(a,u);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(Z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ie())}isEqual(e){return this.batchId===e.batchId&&xn(this.mutations,e.mutations,(t,r)=>op(t,r))&&xn(this.baseMutations,e.baseMutations,(t,r)=>op(t,r))}},kc=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ee(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return pw})(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Dc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ne,z;function Aw(n){switch(n){case R.OK:return B(64938);case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0;default:return B(15467,{code:n})}}function bw(n){if(n===void 0)return nn("GRPC error has no .code"),R.UNKNOWN;switch(n){case ne.OK:return R.OK;case ne.CANCELLED:return R.CANCELLED;case ne.UNKNOWN:return R.UNKNOWN;case ne.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ne.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ne.INTERNAL:return R.INTERNAL;case ne.UNAVAILABLE:return R.UNAVAILABLE;case ne.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ne.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ne.NOT_FOUND:return R.NOT_FOUND;case ne.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ne.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ne.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ne.ABORTED:return R.ABORTED;case ne.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ne.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ne.DATA_LOSS:return R.DATA_LOSS;default:return B(39323,{code:n})}}(z=ne||(ne={}))[z.OK=0]="OK",z[z.CANCELLED=1]="CANCELLED",z[z.UNKNOWN=2]="UNKNOWN",z[z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",z[z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",z[z.NOT_FOUND=5]="NOT_FOUND",z[z.ALREADY_EXISTS=6]="ALREADY_EXISTS",z[z.PERMISSION_DENIED=7]="PERMISSION_DENIED",z[z.UNAUTHENTICATED=16]="UNAUTHENTICATED",z[z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",z[z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",z[z.ABORTED=10]="ABORTED",z[z.OUT_OF_RANGE=11]="OUT_OF_RANGE",z[z.UNIMPLEMENTED=12]="UNIMPLEMENTED",z[z.INTERNAL=13]="INTERNAL",z[z.UNAVAILABLE=14]="UNAVAILABLE",z[z.DATA_LOSS=15]="DATA_LOSS";var OS=new cs([4294967295,4294967295],0);var Nc=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Oc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Rw(n,e){return Oc(n,e.toTimestamp())}function kn(n){return ee(!!n,49232),Z.fromTimestamp((function(t){let r=kt(t);return new ce(r.seconds,r.nanos)})(n))}function pm(n,e){return xc(n,e).canonicalString()}function xc(n,e){let t=(function(i){return new ae(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Pw(n){let e=ae.fromString(n);return ee(Lw(e),10190,{key:e.toString()}),e}function Vc(n,e){return pm(n.databaseId,e.path)}function Cw(n){let e=Pw(n);return e.length===4?ae.emptyPath():Dw(e)}function kw(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Dw(n){return ee(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function up(n,e,t){return{name:Vc(n,e),fields:t.value.mapValue.fields}}function Nw(n,e){let t;if(e instanceof un)t={update:up(n,e.key,e.value)};else if(e instanceof bs)t={delete:Vc(n,e.key)};else if(e instanceof ft)t={update:up(n,e.key,e.data),updateMask:Vw(e.fieldMask)};else{if(!(e instanceof Pc))return B(16599,{Rt:e.type});t={verify:Vc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(o,a){let u=a.transform;if(u instanceof $n)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof an)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof cn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof qn)return{fieldPath:a.field.canonicalString(),increment:u.Ee};throw B(20930,{transform:a.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:Rw(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:B(27497)})(n,e.precondition)),t}function Ow(n,e){return n&&n.length>0?(ee(e!==void 0,14353),n.map(t=>(function(i,o){let a=i.updateTime?kn(i.updateTime):kn(o);return a.isEqual(Z.min())&&(a=kn(o)),new Rc(a,i.transformResults||[])})(t,e))):[]}function xw(n){let e=Cw(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ee(r===1,65062);let m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let o=[];t.where&&(o=(function(g){let w=mm(g);return w instanceof Dt&&Xp(w)?w.getFilters():[w]})(t.where));let a=[];t.orderBy&&(a=(function(g){return g.map(w=>(function(S){return new Un(Rn(S.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(w))})(t.orderBy));let u=null;t.limit&&(u=(function(g){let w;return w=typeof g=="object"?g.value:g,ku(w)?null:w})(t.limit));let h=null;t.startAt&&(h=(function(g){let w=!!g.before,C=g.values||[];return new Fn(C,w)})(t.startAt));let d=null;return t.endAt&&(d=(function(g){let w=!g.before,C=g.values||[];return new Fn(C,w)})(t.endAt)),aw(e,i,a,o,u,"F",h,d)}function mm(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Rn(t.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Rn(t.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Rn(t.unaryFilter.field);return he.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Rn(t.unaryFilter.field);return he.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return B(61313);default:return B(60726)}})(n):n.fieldFilter!==void 0?(function(t){return he.create(Rn(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return B(58110);default:return B(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Dt.create(t.compositeFilter.filters.map(r=>mm(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return B(1026)}})(t.compositeFilter.op))})(n):B(30097,{filter:n})}function Rn(n){return De.fromServerFormat(n.fieldPath)}function Vw(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Lw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Lc=class{constructor(e){this.gt=e}};function Mw(n){let e=xw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sc(e,e.limit,"L"):e}var Ss=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(ie(e.integerValue));else if("doubleValue"in e){let r=ie(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),qr(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=kt(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(sn(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?Qp(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Kp(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):B(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let o=e.fields||{};this.Ct(t,53);let a=zr,u=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(ie(u)),this.xt(a,t),this.Dt(o[a],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),j.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};Ss.Ut=new Ss;var Mc=class{constructor(){this.Dn=new Fc}addToCollectionParentIndex(e,t){return this.Dn.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(rn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(rn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Fc=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ve(ae.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ve(ae.comparator)).toArray()}};var xS=new Uint8Array(0);var lp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gm=41943040,Me=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Me.DEFAULT_COLLECTION_PERCENTILE=10,Me.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Me.DEFAULT=new Me(gm,Me.DEFAULT_COLLECTION_PERCENTILE,Me.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Me.DISABLED=new Me(-1,0,0);var Gr=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var hp="LruGarbageCollector",Fw=1048576;function dp([n,e],[t,r]){let i=W(n,t);return i===0?W(e,r):i}var Uc=class{constructor(e){this.Tr=e,this.buffer=new ve(dp),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();dp(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Bc=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){O(hp,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xr(t)?O(hp,"Ignoring IndexedDB error during garbage collection: ",t):await Pu(t)}await this.Rr(3e5)})}},jc=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(Rp.ue);let r=new Uc(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(lp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lp):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,o,a,u,h,d,m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,a=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,u=Date.now(),this.removeTargets(e,r,t))).next(g=>(o=g,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(d=Date.now(),Sn()<=q.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(u-a)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${g} documents in `+(d-h)+`ms
Total Duration: ${d-m}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:g})))}};function Uw(n,e){return new jc(n,e)}var $c=class{constructor(){this.changes=new dt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var qc=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var zc=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ur(r.mutation,i,Xe.empty(),ce.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ie()){let i=Qt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=ds();return o.forEach((u,h)=>{a=a.insert(u,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=Qt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ie()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let o=As(),a=Fr(),u=(function(){return Fr()})();return t.forEach((h,d)=>{let m=r.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof ft)?o=o.insert(d.key,d):m!==void 0?(a.set(d.key,m.mutation.getFieldMask()),Ur(m.mutation,d,m.mutation.getFieldMask(),ce.now())):a.set(d.key,Xe.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,m)=>a.set(d,m)),t.forEach((d,m)=>{var g;return u.set(d,new qc(m,(g=a.get(d))!==null&&g!==void 0?g:null))}),u))}recalculateAndSaveOverlays(e,t){let r=Fr(),i=new Oe((a,u)=>a-u),o=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let m=r.get(h)||Xe.empty();m=u.applyToLocalView(d,m),r.set(h,m);let g=(i.get(u.batchId)||Ie()).add(h);i=i.insert(u.batchId,g)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let h=u.getNext(),d=h.key,m=h.value,g=om();m.forEach(w=>{if(!o.has(w)){let C=dm(t.get(w),r.get(w));C!==null&&g.set(w,C),o=o.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,g))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return j.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):uw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):P.resolve(Qt()),u=$r,h=o;return a.next(d=>P.forEach(d,(m,g)=>(u<g.largestBatchId&&(u=g.largestBatchId),o.get(m)?P.resolve():this.remoteDocumentCache.getEntry(e,m).next(w=>{h=h.insert(m,w)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,Ie())).next(m=>({batchId:u,changes:sm(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(r=>{let i=ds();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=ds();return this.indexManager.getCollectionParents(e,o).next(u=>P.forEach(u,h=>{let d=(function(g,w){return new Bn(w,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(m=>{m.forEach((g,w)=>{a=a.insert(g,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let m=d.getKey();a.get(m)===null&&(a=a.insert(m,Mn.newInvalidDocument(m)))});let u=ds();return a.forEach((h,d)=>{let m=o.get(h);m!==void 0&&Ur(m.mutation,d,Xe.empty(),ce.now()),Fu(t,d)&&(u=u.insert(h,d))}),u})}};var Wc=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return P.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:kn(i.createTime)}})(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:Mw(i.bundledQuery),readTime:kn(i.readTime)}})(t)),P.resolve()}};var Gc=class{constructor(){this.overlays=new Oe(j.comparator),this.kr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Qt();return P.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.wt(e,t,o)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=Qt(),o=t.length+1,a=new j(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Oe((d,m)=>d-m),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let m=o.get(d.largestBatchId);m===null&&(m=Qt(),o=o.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}let u=Qt(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,m)=>u.set(d,m)),!(u.size()>=i)););return P.resolve(u)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Dc(t,r));let o=this.kr.get(t);o===void 0&&(o=Ie(),this.kr.set(t,o)),this.kr.set(t,o.add(r.key))}};var Hc=class{constructor(){this.sessionToken=ht.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var Hr=class{constructor(){this.qr=new ve(re.Qr),this.$r=new ve(re.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new re(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new re(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new j(new ae([])),r=new re(t,e),i=new re(t,e+1),o=[];return this.$r.forEachInRange([r,i],a=>{this.Wr(a),o.push(a.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new j(new ae([])),r=new re(t,e),i=new re(t,e+1),o=Ie();return this.$r.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new re(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},re=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return j.comparator(e.key,t.key)||W(e.Hr,t.Hr)}static Ur(e,t){return W(e.Hr,t.Hr)||j.comparator(e.key,t.key)}};var Kc=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new ve(re.Qr)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Cc(o,t,r,i);this.mutationQueue.push(a);for(let u of i)this.Yr=this.Yr.add(new re(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),o=i<0?0:i;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?Cu:this.er-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new re(t,0),i=new re(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,i],a=>{let u=this.Zr(a.Hr);o.push(u)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(W);return t.forEach(i=>{let o=new re(i,0),a=new re(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,a],u=>{r=r.add(u.Hr)})}),P.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;j.isDocumentKey(o)||(o=o.child(""));let a=new re(new j(o),0),u=new ve(W);return this.Yr.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Hr)),!0)},a),P.resolve(this.ei(u))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ee(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return P.forEach(t.mutations,i=>{let o=new re(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new re(t,0),i=this.Yr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Qc=class{constructor(e){this.ni=e,this.docs=(function(){return new Oe(j.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():Mn.newInvalidDocument(t))}getEntries(e,t){let r=As();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Mn.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=As(),a=t.path,u=new j(a.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){let{key:d,value:{document:m}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||$E(jE(m),r)<=0||(i.has(m.key)||Fu(t,m))&&(o=o.insert(m.key,m.mutableCopy()))}return P.resolve(o)}getAllFromCollectionGroup(e,t,r,i){B(9500)}ri(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Jc(this)}getSize(e){return P.resolve(this.size)}},Jc=class extends $c{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var Yc=class{constructor(e){this.persistence=e,this.ii=new dt(t=>Lu(t),Mu),this.lastRemoteSnapshotVersion=Z.min(),this.highestTargetId=0,this.si=0,this.oi=new Hr,this.targetCount=0,this._i=Gr.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),P.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new Gr(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.hr(t),P.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ii.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ii.delete(a),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),P.waitFor(o).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.oi.containsKey(t))}};var Rs=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new Rp(0),this.ci=!1,this.ci=!0,this.li=new Hc,this.referenceDelegate=e(this),this.hi=new Yc(this),this.indexManager=new Mc,this.remoteDocumentCache=(function(i){return new Qc(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new Lc(t),this.Ti=new Wc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Gc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new Kc(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new Xc(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,t){return P.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},Xc=class extends hc{constructor(e){super(),this.currentSequenceNumber=e}},Zc=class n{constructor(e){this.persistence=e,this.Ai=new Hr,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw B(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),P.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.mi,r=>{let i=j.fromPath(r);return this.fi(e,i).next(o=>{o||t.removeEntry(i,Z.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return P.or([()=>P.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Ps=class n{constructor(e,t){this.persistence=e,this.gi=new dt(r=>GE(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=Uw(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return P.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(o=>o?P.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,a=>this.Sr(e,a,t).next(u=>{u||(r++,o.removeEntry(a,Z.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),P.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ps(e.data.value)),t}Sr(e,t,r){return P.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return P.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var eu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=Ie(),i=Ie();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var tu=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var nu=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return ud()?8:zE(ue())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ps(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ys(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new tu;return this.ws(e,t,a).next(u=>{if(o.result=u,this.Rs)return this.Ss(e,t,a,u.size)})}).next(()=>o.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Sn()<=q.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Vr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),P.resolve()):(Sn()<=q.DEBUG&&O("QueryEngine","Query:",Vr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Sn()<=q.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Vr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jt(t))):P.resolve())}ps(e,t){if(ip(t))return P.resolve(null);let r=Jt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Sc(t,null,"F"),r=Jt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=Ie(...o);return this.gs.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.bs(t,u);return this.Ds(t,d,a,h.readTime)?this.ps(e,Sc(t,null,"F")):this.vs(e,d,t,h)}))})))}ys(e,t,r,i){return ip(t)||i.isEqual(Z.min())?P.resolve(null):this.gs.getDocuments(e,r).next(o=>{let a=this.bs(t,o);return this.Ds(t,a,r,i)?P.resolve(null):(Sn()<=q.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Vr(t)),this.vs(e,a,t,BE(i,$r)).next(u=>u))})}bs(e,t){let r=new ve(hw(e));return t.forEach((i,o)=>{Fu(e,o)&&(r=r.add(o))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,t,r){return Sn()<=q.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Vr(t)),this.gs.getDocumentsMatchingQuery(e,t,rn.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var Bw="LocalStore";var ru=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new Oe(W),this.Ms=new dt(o=>Lu(o),Mu),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zc(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function jw(n,e,t,r){return new ru(n,e,t,r)}async function _m(n,e){let t=Q(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],u=[],h=Ie();for(let d of i){a.push(d.batchId);for(let m of d.mutations)h=h.add(m.key)}for(let d of o){u.push(d.batchId);for(let m of d.mutations)h=h.add(m.key)}return t.localDocuments.getDocuments(r,h).next(d=>({Bs:d,removedBatchIds:a,addedBatchIds:u}))})})}function $w(n,e){let t=Q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Os.newChangeBuffer({trackRemovals:!0});return(function(u,h,d,m){let g=d.batch,w=g.keys(),C=P.resolve();return w.forEach(S=>{C=C.next(()=>m.getEntry(h,S)).next(k=>{let N=d.docVersions.get(S);ee(N!==null,48541),k.version.compareTo(N)<0&&(g.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),m.addEntry(k)))})}),C.next(()=>u.mutationQueue.removeMutationBatch(h,g))})(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let h=Ie();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function qw(n){let e=Q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function zw(n,e){let t=Q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Cu),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}var Cs=class{constructor(){this.activeTargetIds=_w()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var iu=class{constructor(){this.Fo=new Cs,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Cs,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var su=class{xo(e){}shutdown(){}};var fp="ConnectivityMonitor",ks=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){O(fp,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){O(fp,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var fs=null;function ou(){return fs===null?fs=(function(){return 268435456+Math.round(2147483648*Math.random())})():fs++,"0x"+fs.toString(16)}var Za="RestConnection",Ww={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},au=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===ws?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){let a=ou(),u=this.Go(e,t.toUriEncodedString());O(Za,`Sending RPC '${e}' ${a}:`,u,r);let h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,i,o);let{host:d}=new URL(u),m=It(d);return this.jo(e,u,h,r,m).then(g=>(O(Za,`Received RPC '${e}' ${a}: `,g),g),g=>{throw On(Za,`RPC '${e}' ${a} failed with error: `,g,"url: ",u,"request:",r),g})}Jo(e,t,r,i,o,a){return this.Wo(e,t,r,i,o)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wn})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}Go(e,t){let r=Ww[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var cu=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var ye="WebChannelConnection",uu=class extends au{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,o){let a=ou();return new Promise((u,h)=>{let d=new Ka;d.setWithCredentials(!0),d.listenOnce(Qa.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case xr.NO_ERROR:let g=d.getResponseJson();O(ye,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),u(g);break;case xr.TIMEOUT:O(ye,`RPC '${e}' ${a} timed out`),h(new x(R.DEADLINE_EXCEEDED,"Request time out"));break;case xr.HTTP_ERROR:let w=d.getStatus();if(O(ye,`RPC '${e}' ${a} failed with status:`,w,"response text:",d.getResponseText()),w>0){let C=d.getResponseJson();Array.isArray(C)&&(C=C[0]);let S=C?.error;if(S&&S.status&&S.message){let k=(function(U){let F=U.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(F)>=0?F:R.UNKNOWN})(S.status);h(new x(k,S.message))}else h(new x(R.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new x(R.UNAVAILABLE,"Connection failed."));break;default:B(9055,{c_:e,streamId:a,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{O(ye,`RPC '${e}' ${a} completed.`)}});let m=JSON.stringify(i);O(ye,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",m,r,15)})}P_(e,t,r){let i=ou(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Xa(),u=Ya(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let m=o.join("");O(ye,`Creating RPC '${e}' stream ${i}: ${m}`,h);let g=a.createWebChannel(m,h);this.T_(g);let w=!1,C=!1,S=new cu({Ho:N=>{C?O(ye,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(w||(O(ye,`Opening RPC '${e}' stream ${i} transport.`),g.open(),w=!0),O(ye,`RPC '${e}' stream ${i} sending:`,N),g.send(N))},Yo:()=>g.close()}),k=(N,U,F)=>{N.listen(U,$=>{try{F($)}catch(V){setTimeout(()=>{throw V},0)}})};return k(g,bn.EventType.OPEN,()=>{C||(O(ye,`RPC '${e}' stream ${i} transport opened.`),S.s_())}),k(g,bn.EventType.CLOSE,()=>{C||(C=!0,O(ye,`RPC '${e}' stream ${i} transport closed`),S.__(),this.I_(g))}),k(g,bn.EventType.ERROR,N=>{C||(C=!0,On(ye,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),S.__(new x(R.UNAVAILABLE,"The operation could not be completed")))}),k(g,bn.EventType.MESSAGE,N=>{var U;if(!C){let F=N.data[0];ee(!!F,16349);let $=F,V=$?.error||((U=$[0])===null||U===void 0?void 0:U.error);if(V){O(ye,`RPC '${e}' stream ${i} received error:`,V);let H=V.status,M=(function(_){let I=ne[_];if(I!==void 0)return bw(I)})(H),v=V.message;M===void 0&&(M=R.INTERNAL,v="Unknown error status: "+H+" with message "+V.message),C=!0,S.__(new x(M,v)),g.close()}else O(ye,`RPC '${e}' stream ${i} received:`,F),S.a_(F)}}),k(u,Ja.STAT_EVENT,N=>{N.stat===ls.PROXY?O(ye,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===ls.NOPROXY&&O(ye,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.o_()},0),S}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function ec(){return typeof document<"u"?document:null}function Fs(n){return new Nc(n,!0)}var Ds=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var pp="PersistentStream",lu=class{constructor(e,t,r,i,o,a,u,h){this.Fi=e,this.w_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Ds(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(nn(t.toString()),nn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new x(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return O(pp,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(O(pp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var hu=class extends lu{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=Ow(e.writeResults,e.commitTime),r=kn(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=kw(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Nw(this.serializer,r))};this.k_(t)}};var du=class{},fu=class extends du{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new x(R.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Wo(e,xc(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(R.UNKNOWN,o.toString())})}Jo(e,t,r,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Jo(e,xc(t,r),i,a,u,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(R.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},pu=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(nn(t),this._a=!1):O("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Zr="RemoteStore",mu=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(a=>{r.enqueueAndForget(async()=>{ti(this)&&(O(Zr,"Restarting streams for network reachability change."),await(async function(h){let d=Q(h);d.Ia.add(4),await ei(d),d.Aa.set("Unknown"),d.Ia.delete(4),await Us(d)})(this))})}),this.Aa=new pu(r,i)}};async function Us(n){if(ti(n))for(let e of n.da)await e(!0)}async function ei(n){for(let e of n.da)await e(!1)}function ti(n){return Q(n).Ia.size===0}async function ym(n,e,t){if(!Xr(e))throw e;n.Ia.add(1),await ei(n),n.Aa.set("Offline"),t||(t=()=>qw(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{O(Zr,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Us(n)})}function Im(n,e){return e().catch(t=>ym(n,t,e))}async function Bs(n){let e=Q(n),t=Nt(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Cu;for(;Gw(e);)try{let i=await zw(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,Hw(e,i)}catch(i){await ym(e,i)}vm(e)&&Em(e)}function Gw(n){return ti(n)&&n.Pa.length<10}function Hw(n,e){n.Pa.push(e);let t=Nt(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function vm(n){return ti(n)&&!Nt(n).M_()&&n.Pa.length>0}function Em(n){Nt(n).start()}async function Kw(n){Nt(n).na()}async function Qw(n){let e=Nt(n);for(let t of n.Pa)e.X_(t.mutations)}async function Jw(n,e,t){let r=n.Pa.shift(),i=kc.from(r,e,t);await Im(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Bs(n)}async function Yw(n,e){e&&Nt(n).Z_&&await(async function(r,i){if((function(a){return Aw(a)&&a!==R.ABORTED})(i.code)){let o=r.Pa.shift();Nt(r).N_(),await Im(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Bs(r)}})(n,e),vm(n)&&Em(n)}async function mp(n,e){let t=Q(n);t.asyncQueue.verifyOperationInProgress(),O(Zr,"RemoteStore received new credentials");let r=ti(t);t.Ia.add(3),await ei(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Us(t)}async function Xw(n,e){let t=Q(n);e?(t.Ia.delete(2),await Us(t)):e||(t.Ia.add(2),await ei(t),t.Aa.set("Unknown"))}function Nt(n){return n.ma||(n.ma=(function(t,r,i){let o=Q(t);return o.ia(),new hu(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:Kw.bind(null,n),n_:Yw.bind(null,n),ea:Qw.bind(null,n),ta:Jw.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await Bs(n)):(await n.ma.stop(),n.Pa.length>0&&(O(Zr,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}var gu=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new lt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,u=new n(e,t,a,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function wm(n,e){if(nn("AsyncQueue",`${e}: ${n}`),Xr(n))return new x(R.UNAVAILABLE,`${e}: ${n}`);throw n}var _u=class{constructor(){this.queries=gp(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=Q(t),o=i.queries;i.queries=gp(),o.forEach((a,u)=>{for(let h of u.wa)h.onError(r)})})(this,new x(R.ABORTED,"Firestore shutting down"))}};function gp(){return new dt(n=>rm(n),nm)}function Zw(n){n.Da.forEach(e=>{e.next()})}var _p,yp;(yp=_p||(_p={})).Fa="default",yp.Cache="cache";var eT="SyncEngine";var yu=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new dt(u=>rm(u),nm),this.Tu=new Map,this.Iu=new Set,this.du=new Oe(j.comparator),this.Eu=new Map,this.Au=new Hr,this.Ru={},this.Vu=new Map,this.mu=Gr.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function tT(n,e,t){let r=sT(n);try{let i=await(function(a,u){let h=Q(a),d=ce.now(),m=u.reduce((C,S)=>C.add(S.key),Ie()),g,w;return h.persistence.runTransaction("Locally write mutations","readwrite",C=>{let S=As(),k=Ie();return h.Os.getEntries(C,m).next(N=>{S=N,S.forEach((U,F)=>{F.isValidDocument()||(k=k.add(U))})}).next(()=>h.localDocuments.getOverlayedDocuments(C,S)).next(N=>{g=N;let U=[];for(let F of u){let $=Tw(F,g.get(F.key).overlayedDocument);$!=null&&U.push(new ft(F.key,$,Jp($.value.mapValue),Yt.exists(!0)))}return h.mutationQueue.addMutationBatch(C,d,U,u)}).next(N=>{w=N;let U=N.applyToLocalDocumentSet(g,k);return h.documentOverlayCache.saveOverlays(C,N.batchId,U)})}).then(()=>({batchId:w.batchId,changes:sm(g)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,u,h){let d=a.Ru[a.currentUser.toKey()];d||(d=new Oe(W)),d=d.insert(u,h),a.Ru[a.currentUser.toKey()]=d})(r,i.batchId,t),await js(r,i.changes),await Bs(r.remoteStore)}catch(i){let o=wm(i,"Failed to persist write");t.reject(o)}}function Ip(n,e,t){let r=Q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((o,a)=>{let u=a.view.va(e);u.snapshot&&i.push(u.snapshot)}),(function(a,u){let h=Q(a);h.onlineState=u;let d=!1;h.queries.forEach((m,g)=>{for(let w of g.wa)w.va(u)&&(d=!0)}),d&&Zw(h)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nT(n,e){let t=Q(n),r=e.batch.batchId;try{let i=await $w(t.localStore,e);Am(t,r,null),Tm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await js(t,i)}catch(i){await Pu(i)}}async function rT(n,e,t){let r=Q(n);try{let i=await(function(a,u){let h=Q(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return h.mutationQueue.lookupMutationBatch(d,u).next(g=>(ee(g!==null,37113),m=g.keys(),h.mutationQueue.removeMutationBatch(d,g))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,m,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>h.localDocuments.getDocuments(d,m))})})(r.localStore,e);Am(r,e,t),Tm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await js(r,i)}catch(i){await Pu(i)}}function Tm(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function Am(n,e,t){let r=Q(n),i=r.Ru[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}async function js(n,e,t){let r=Q(n),i=[],o=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach((u,h)=>{a.push(r.gu(h,e,t).then(d=>{var m;if((d||t)&&r.isPrimaryClient){let g=d?!d.fromCache:(m=t?.targetChanges.get(h.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(h.targetId,g?"current":"not-current")}if(d){i.push(d);let g=eu.Es(h.targetId,d);o.push(g)}}))}),await Promise.all(a),r.hu.J_(i),await(async function(h,d){let m=Q(h);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>P.forEach(d,w=>P.forEach(w.Is,C=>m.persistence.referenceDelegate.addReference(g,w.targetId,C)).next(()=>P.forEach(w.ds,C=>m.persistence.referenceDelegate.removeReference(g,w.targetId,C)))))}catch(g){if(!Xr(g))throw g;O(Bw,"Failed to update sequence numbers: "+g)}for(let g of d){let w=g.targetId;if(!g.fromCache){let C=m.Fs.get(w),S=C.snapshotVersion,k=C.withLastLimboFreeSnapshotVersion(S);m.Fs=m.Fs.insert(w,k)}}})(r.localStore,o))}async function iT(n,e){let t=Q(n);if(!t.currentUser.isEqual(e)){O(eT,"User change. New user:",e.toKey());let r=await _m(t.localStore,e);t.currentUser=e,(function(o,a){o.Vu.forEach(u=>{u.forEach(h=>{h.reject(new x(R.CANCELLED,a))})}),o.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await js(t,r.Bs)}}function sT(n){let e=Q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rT.bind(null,e),e}var bm=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Fs(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return jw(this.persistence,new nu,t.initialUser,this.serializer)}Du(t){return new Rs(Zc.Vi,this.serializer)}bu(t){return new iu}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Iu=class extends bm{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ee(this.persistence.referenceDelegate instanceof Ps,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Bc(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?Me.withCacheSize(this.cacheSizeBytes):Me.DEFAULT;return new Rs(r=>Ps.Vi(r,t),this.serializer)}};var oT=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ip(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=iT.bind(null,this.syncEngine),await Xw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new _u})()}createDatastore(t){let r=Fs(t.databaseInfo.databaseId),i=(function(a){return new uu(a)})(t.databaseInfo);return(function(a,u,h,d){return new fu(a,u,h,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,o,a,u,h){return new mu(i,o,a,u,h)})(this.localStore,this.datastore,t.asyncQueue,r=>Ip(this.syncEngine,r,0),(function(){return ks.C()?new ks:new su})())}createSyncEngine(t,r){return(function(o,a,u,h,d,m,g){let w=new yu(o,a,u,h,d,m);return g&&(w.fu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await(async function(o){let a=Q(o);O(Zr,"RemoteStore shutting down."),a.Ia.add(5),await ei(a),a.Ea.shutdown(),a.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}return n.provider={build:()=>new n},n})();var Ot="FirestoreClient",vu=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=le.UNAUTHENTICATED,this.clientId=jr.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async a=>{O(Ot,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(O(Ot,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new lt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=wm(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function tc(n,e){n.asyncQueue.verifyOperationInProgress(),O(Ot,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await _m(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{On("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{O("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{On("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e}async function vp(n,e){n.asyncQueue.verifyOperationInProgress();let t=await aT(n);O(Ot,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>mp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>mp(e.remoteStore,i)),n._onlineComponents=e}async function aT(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O(Ot,"Using user provided OfflineComponentProvider");try{await tc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;On("Error using user provided cache. Falling back to memory cache: "+t),await tc(n,new bm)}}else O(Ot,"Using default OfflineComponentProvider"),await tc(n,new Iu(void 0));return n._offlineComponents}async function cT(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(O(Ot,"Using user provided OnlineComponentProvider"),await vp(n,n._uninitializedComponentsProvider._online)):(O(Ot,"Using default OnlineComponentProvider"),await vp(n,new oT))),n._onlineComponents}function uT(n){return cT(n).then(e=>e.syncEngine)}function Sm(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Ep=new Map;var Rm="firestore.googleapis.com",wp=!0,Ns=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rm,this.ssl=wp}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:wp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=gm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Fw)throw new x(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}UE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Sm((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Kr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ns({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ns(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new nc;switch(r.type){case"firstParty":return new oc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=Ep.get(t);r&&(O("ComponentProvider","Removing Datastore"),Ep.delete(t),r.terminate())})(this),Promise.resolve()}};function Pm(n,e,t,r={}){var i;n=uc(n,Kr);let o=It(e),a=n._getSettings(),u=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;o&&(Li(`https://${h}`),Mi("Firestore",!0)),a.host!==Rm&&a.host!==h&&On("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:h,ssl:o,emulatorOptions:r});if(!Ge(d,u)&&(n._setSettings(d),r.mockUserToken)){let m,g;if(typeof r.mockUserToken=="string")m=r.mockUserToken,g=le.MOCK_USER;else{m=rd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new x(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new le(w)}n._authCredentials=new rc(new _s(m,g))}}var Eu=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ne=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Yr(t,n._jsonSchema))return new n(e,r||null,new j(ae.fromString(t.referencePath)))}};Ne._jsonSchemaVersion="firestore/documentReference/1.0",Ne._jsonSchema={type:se("string",Ne._jsonSchemaVersion),referencePath:se("string")};var Qr=class n extends Eu{constructor(e,t,r){super(e,t,cw(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ne(this.firestore,null,new j(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Cm(n,e,...t){if(n=Ae(n),arguments.length===1&&(e=jr.newId()),FE("doc","path",e),n instanceof Kr){let r=ae.fromString(e,...t);return Kf(r),new Ne(n,null,new j(r))}{if(!(n instanceof Ne||n instanceof Qr))throw new x(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ae.fromString(e,...t));return Kf(r),new Ne(n.firestore,n instanceof Qr?n.converter:null,new j(r))}}var Tp="AsyncQueue",Os=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Ds(this,"async_queue_retry"),this.oc=()=>{let r=ec();r&&O(Tp,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=ec();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=ec();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new lt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Xr(e))throw e;O(Tp,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,nn("INTERNAL UNHANDLED ERROR: ",Ap(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=gu.createAndSchedule(this,e,t,r,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&B(47125,{hc:Ap(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function Ap(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var xs=class extends Kr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Os,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Os(e),this._firestoreClient=void 0,await e}}};function km(n,e){let t=typeof n=="object"?n:jt(),r=typeof n=="string"?n:e||ws,i=In(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=nd("firestore");o&&Pm(i,...o)}return i}function lT(n){if(n._terminated)throw new x(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||hT(n),n._firestoreClient}function hT(n){var e,t,r;let i=n._freezeSettings(),o=(function(u,h,d,m){return new fc(u,h,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,Sm(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new vu(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(u){let h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}})(n._componentsProvider))}var Xt=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(ht.fromBase64String(e))}catch(t){throw new x(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yr(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Xt._jsonSchemaVersion="firestore/bytes/1.0",Xt._jsonSchema={type:se("string",Xt._jsonSchemaVersion),bytes:se("string")};var Jr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new De(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Vs=class{constructor(e){this._methodName=e}};var Zt=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return W(this._lat,e._lat)||W(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Yr(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Zt._jsonSchemaVersion="firestore/geoPoint/1.0",Zt._jsonSchema={type:se("string",Zt._jsonSchemaVersion),latitude:se("number"),longitude:se("number")};var en=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yr(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new x(R.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};en._jsonSchemaVersion="firestore/vectorValue/1.0",en._jsonSchema={type:se("string",en._jsonSchemaVersion),vectorValues:se("object")};var dT=/^__.*__$/,wu=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ft(e,this.data,this.fieldMask,t,this.fieldTransforms):new un(e,this.data,t,this.fieldTransforms)}};function Dm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B(40011,{Ec:n})}}var Tu=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Ls(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Dm(this.Ec)&&dT.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},Au=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Fs(e)}Dc(e,t,r,i=!1){return new Tu({Ec:e,methodName:t,bc:r,path:De.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function fT(n){let e=n._freezeSettings(),t=Fs(n._databaseId);return new Au(n._databaseId,!!e.ignoreUndefinedProperties,t)}function pT(n,e,t,r,i,o={}){let a=n.Dc(o.merge||o.mergeFields?2:0,e,t,i);Vm("Data must be an object, but it was:",a,r);let u=Om(r,a),h,d;if(o.merge)h=new Xe(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let m=[];for(let g of o.mergeFields){let w=mT(e,g,t);if(!a.contains(w))throw new x(R.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);_T(m,w)||m.push(w)}h=new Xe(m),d=a.fieldTransforms.filter(g=>h.covers(g.field))}else h=null,d=a.fieldTransforms;return new wu(new Ye(u),h,d)}function Nm(n,e){if(xm(n=Ae(n)))return Vm("Unsupported field value:",e,n),Om(n,e);if(n instanceof Vs)return(function(r,i){if(!Dm(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let o=[],a=0;for(let u of r){let h=Nm(u,i.yc(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=Ae(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return yw(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ce.fromDate(r);return{timestampValue:Oc(i.serializer,o)}}if(r instanceof ce){let o=new ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Oc(i.serializer,o)}}if(r instanceof Zt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Xt)return{bytesValue:Sw(i.serializer,r._byteString)};if(r instanceof Ne){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:pm(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof en)return(function(a,u){return{mapValue:{fields:{[Ou]:{stringValue:xu},[zr]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return Uu(u.serializer,d)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${Ru(r)}`)})(n,e)}function Om(n,e){let t={};return $p(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gn(n,(r,i)=>{let o=Nm(i,e.Vc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function xm(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ce||n instanceof Zt||n instanceof Xt||n instanceof Ne||n instanceof Vs||n instanceof en)}function Vm(n,e,t){if(!xm(t)||!Sp(t)){let r=Ru(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function mT(n,e,t){if((e=Ae(e))instanceof Jr)return e._internalPath;if(typeof e=="string")return Lm(n,e);throw Ls("Field path arguments must be of type string or ",n,!1,void 0,t)}var gT=new RegExp("[~\\*/\\[\\]]");function Lm(n,e,t){if(e.search(gT)>=0)throw Ls(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Jr(...e.split("."))._internalPath}catch{throw Ls(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ls(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new x(R.INVALID_ARGUMENT,u+n+h)}function _T(n,e){return n.some(t=>t.isEqual(e))}var Ms=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ne(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new bu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Mm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},bu=class extends Ms{data(){return super.data()}};function Mm(n,e){return typeof e=="string"?Lm(n,e):e instanceof Jr?e._internalPath:e._delegate._internalPath}function yT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Cn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Dn=class n extends Ms{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Nn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Mm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new x(R.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Dn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Dn._jsonSchema={type:se("string",Dn._jsonSchemaVersion),bundleSource:se("string","DocumentSnapshot"),bundleName:se("string"),bundle:se("string")};var Nn=class extends Dn{data(e={}){return super.data(e)}},Br=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Cn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Nn(this._firestore,this._userDataWriter,r.key,r,new Cn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let h=new Nn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Cn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{let h=new Nn(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Cn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,m=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),m=a.indexOf(u.doc.key)),{type:IT(u.type),doc:h,oldIndex:d,newIndex:m}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new x(R.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=jr.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function IT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B(61501,{type:n})}}Br._jsonSchemaVersion="firestore/querySnapshot/1.0",Br._jsonSchema={type:se("string",Br._jsonSchemaVersion),bundleSource:se("string","QuerySnapshot"),bundleName:se("string"),bundle:se("string")};function Fm(n,e,t){n=uc(n,Ne);let r=uc(n.firestore,xs),i=yT(n.converter,e,t);return vT(r,[pT(fT(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Yt.none())])}function vT(n,e){return(function(r,i){let o=new lt;return r.asyncQueue.enqueueAndForget(async()=>tT(await uT(r),i,o)),o.promise})(lT(n),e)}(function(e,t=!0){(function(i){Wn=i})(Et),je(new be("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),u=new xs(new ic(r.getProvider("auth-internal")),new ac(a,r.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new x(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pc(d.options.projectId,m)})(a,i),a);return o=Object.assign({useFetchStreams:t},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),X(zf,Wf,e),X(zf,Wf,"esm2017")})();var ln=class{constructor(e){return e}},Um="firestore",Bu=class{constructor(){return wn(Um)}};var ju=new Ce("angularfire2.firestore-instances");function ET(n,e){let t=Er(Um,n,e);return t&&new ln(t)}function wT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ln(r)}}var TT={provide:Bu,deps:[[new xe,ju]]},AT={provide:ln,useFactory:ET,deps:[[new xe,ju],st]};function Bm(n,...e){return X("angularfire",wt.full,"fst"),We([AT,TT,{provide:ju,useFactory:wT(n),multi:!0,deps:[Ve,gn,Tt,qt,[new xe,Or],[new xe,Tn],...e]}])}var jm=Le(Cm,!0,2);var $m=Le(km,!0);var qm=Le(Fm,!0,2);var zm=[{path:"",loadComponent:()=>import("./chunk-CCCTEA36.js").then(n=>n.Landing)},{path:"login",loadComponent:()=>import("./chunk-4OGPVKDH.js").then(n=>n.Login)},{path:"signup",loadComponent:()=>import("./chunk-EN5GMOA4.js").then(n=>n.Signup)},{path:"application",loadComponent:()=>import("./chunk-ZJLSZDXS.js").then(n=>n.Application),children:[{path:"dashboard",loadComponent:()=>import("./chunk-QRZVMFHI.js").then(n=>n.Dashboard)},{path:"settings",loadComponent:()=>import("./chunk-5MG2NIEQ.js").then(n=>n.Settings)},{path:"resumes",loadComponent:()=>import("./chunk-GTUYOALF.js").then(n=>n.Resumes)},{path:"cover-letter",loadComponent:()=>import("./chunk-KARZZBM3.js").then(n=>n.CoverLetter)},{path:"job-tracker",loadComponent:()=>import("./chunk-KVPSBNAU.js").then(n=>n.JobTracker)},{path:"interview-coach",loadComponent:()=>import("./chunk-BUHVJEX3.js").then(n=>n.InterviewCoach)},{path:"linkedin-optimizer",loadComponent:()=>import("./chunk-CFY4PO5F.js").then(n=>n.Linkedin)},{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"**",redirectTo:"dashboard"}]}];var $s=class n{intercept(e,t){return t.handle(e).pipe(ze(r=>{let i="An unknown error occurred!";if(r.error instanceof ErrorEvent)i=`Error: ${r.error.message}`;else switch(r.status){case 400:i="Bad Request. Please check your input.";break;case 401:i="Unauthorized. Please log in again.";break;case 403:i="Forbidden. You do not have permission to perform this action.";break;case 404:i="Not Found. The requested resource was not found.";break;case 500:i="Internal Server Error. Please try again later.";break;default:i=`Error Code: ${r.status}
Message: ${r.message}`}return console.error("HTTP Error:",i),lh(()=>new Error(i))}))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=_e({token:n,factory:n.\u0275fac})};var $u={production:!1,firebase:{apiKey:"AIzaSyAvJWdqhgPO2gqxPmvRhjzj0xK8ay0hp_8",authDomain:"ai-job-seeker-ed1d3.firebaseapp.com",projectId:"ai-job-seeker-ed1d3",storageBucket:"ai-job-seeker-ed1d3.firebasestorage.app",messagingSenderId:"987943610256",appId:"1:987943610256:web:5146c6fb9364d3aef37515",measurementId:"G-XHCDRESMK0"}};var CT={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},qs="__@ngrx/effects_create__";function Wm(n,e={}){let t=e.functional?n:n(),r=Te(Te({},CT),e);return Object.defineProperty(t,qs,{value:r}),t}function kT(n){return Object.getOwnPropertyNames(n).filter(r=>n[r]&&n[r].hasOwnProperty(qs)?n[r][qs].hasOwnProperty("dispatch"):!1).map(r=>{let i=n[r][qs];return Te({propertyName:r},i)})}function DT(n){return kT(n)}function Gm(n){return Object.getPrototypeOf(n)}function NT(n){return!!n.constructor&&n.constructor.name!=="Object"&&n.constructor.name!=="Function"}function Hm(n){return typeof n=="function"}function OT(n){return n.filter(Hm)}function xT(n,e,t){let r=Gm(n),o=!!r&&r.constructor.name!=="Object"?r.constructor.name:null,a=DT(n).map(({propertyName:u,dispatch:h,useEffectsErrorHandler:d})=>{let m=typeof n[u]=="function"?n[u]():n[u],g=d?t(m,e):m;return h===!1?g.pipe(ph()):g.pipe(_h()).pipe(Pe(C=>({effect:n[u],notification:C,propertyName:u,sourceName:o,sourceInstance:n})))});return mn(...a)}var VT=10;function Km(n,e,t=VT){return n.pipe(ze(r=>(e&&e.handleError(r),t<=1?n:Km(n,e,t-1))))}var Qm=(()=>{let e=class e extends yt{constructor(r){super(),r&&(this.source=r)}lift(r){let i=new e;return i.source=this,i.operator=r,i}};e.\u0275fac=function(i){return new(i||e)(te(Ri))},e.\u0275prov=_e({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Jm(...n){return qe(e=>n.some(t=>typeof t=="string"?t===e.type:t.type===e.type))}var LT=new Ce("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>Km}),MT="@ngrx/effects/init",FT=qh(MT);function UT(n,e){if(n.notification.kind==="N"){let t=n.notification.value;!BT(t)&&e.handleError(new Error(`Effect ${jT(n)} dispatched an invalid action: ${$T(t)}`))}}function BT(n){return typeof n!="function"&&n&&n.type&&typeof n.type=="string"}function jT({propertyName:n,sourceInstance:e,sourceName:t}){let r=typeof e[n]=="function";return!!t?`"${t}.${String(n)}${r?"()":""}"`:`"${String(n)}()"`}function $T(n){try{return JSON.stringify(n)}catch{return n}}var qT="ngrxOnIdentifyEffects";function zT(n){return qu(n,qT)}var WT="ngrxOnRunEffects";function GT(n){return qu(n,WT)}var HT="ngrxOnInitEffects";function KT(n){return qu(n,HT)}function qu(n,e){return n&&e in n&&typeof n[e]=="function"}var Ym=(()=>{let e=class e extends sh{constructor(r,i){super(),this.errorHandler=r,this.effectsErrorHandler=i}addEffects(r){this.next(r)}toActions(){return this.pipe(Po(r=>NT(r)?Gm(r):r),Ro(r=>r.pipe(Po(QT))),Ro(r=>{let i=r.pipe(gh(a=>JT(this.errorHandler,this.effectsErrorHandler)(a)),Pe(a=>(UT(a,this.errorHandler),a.notification)),qe(a=>a.kind==="N"&&a.value!=null),mh()),o=r.pipe(wi(1),qe(KT),Pe(a=>a.ngrxOnInitEffects()));return mn(i,o)}))}};e.\u0275fac=function(i){return new(i||e)(te(bi),te(LT))},e.\u0275prov=_e({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function QT(n){return zT(n)?n.ngrxOnIdentifyEffects():""}function JT(n,e){return t=>{let r=xT(t,n,e);return GT(t)?t.ngrxOnRunEffects(r):r}}var YT=(()=>{let e=class e{get isStarted(){return!!this.effectsSubscription}constructor(r,i){this.effectSources=r,this.store=i,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}};e.\u0275fac=function(i){return new(i||e)(te(Ym),te(Pi))},e.\u0275prov=_e({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Xm(...n){let e=n.flat(),t=OT(e);return We([t,Ah(()=>{oe(Wh),oe(Gh,{optional:!0});let r=oe(YT),i=oe(Ym),o=!r.isStarted;o&&r.start();for(let a of e){let u=Hm(a)?oe(a):a;i.addEffects(u)}o&&oe(Pi).dispatch(FT())})])}var XT={user:null,status:"init",error:null},Zm=Yh(XT,Ci(ki,n=>Ue(Te({},n),{status:"loading",error:null})),Ci(Di,(n,{user:e})=>Ue(Te({},n),{user:e,status:"loaded",error:null})),Ci(Ni,(n,{error:e})=>Ue(Te({},n),{user:null,status:"error",error:e})));var zs=class n{constructor(e,t){this.firestore=e;this.auth=t}currentUserSubject=new oh(null);currentUser$=this.currentUserSubject.asObservable();async login(e){try{await Uf(this.auth,e.email,e.password)}catch(t){throw t}}registerUser(e){return So(Mf(this.auth,e.email,e.password)).pipe(Ft(t=>{let r=t.user.uid,i=jm(this.firestore,"users",r),o=t.user.refreshToken;return localStorage.setItem("accessToken",JSON.stringify(o)),So(qm(i,{name:e.name,email:e.email,createdAt:new Date,role:e.role}))}),ze(t=>{throw console.error("Firebase error:",t.code,t.message),t}))}async logout(){try{await Bf(this.auth)}catch(e){throw e}}isAuthenticated(){return this.currentUserSubject.value!==null}getCurrentUser(){return this.currentUserSubject.value}static \u0275fac=function(t){return new(t||n)(te(ln),te(Kt))};static \u0275prov=_e({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ws=class n{actions$=oe(Qm);authService$=oe(zs);signupEffect=Wm(()=>this.actions$.pipe(Jm(ki),Ft(({user:e})=>this.authService$.registerUser(e).pipe(Pe(t=>Di({user:t})),ze(t=>pr(Ni({error:t})))))));static \u0275fac=function(t){return new(t||n)};static \u0275prov=_e({token:n,factory:n.\u0275fac})};var ri="PERFORM_ACTION",ZT="REFRESH",sg="RESET",og="ROLLBACK",ag="COMMIT",cg="SWEEP",ug="TOGGLE_ACTION",eA="SET_ACTIONS_ACTIVE",lg="JUMP_TO_STATE",hg="JUMP_TO_ACTION",nl="IMPORT_STATE",dg="LOCK_CHANGES",fg="PAUSE_RECORDING",Hn=class{constructor(e,t){if(this.action=e,this.timestamp=t,this.type=ri,typeof e.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}},zu=class{constructor(){this.type=ZT}},Wu=class{constructor(e){this.timestamp=e,this.type=sg}},Gu=class{constructor(e){this.timestamp=e,this.type=og}},Hu=class{constructor(e){this.timestamp=e,this.type=ag}},Ku=class{constructor(){this.type=cg}},Qu=class{constructor(e){this.id=e,this.type=ug}};var Ju=class{constructor(e){this.index=e,this.type=lg}},Yu=class{constructor(e){this.actionId=e,this.type=hg}},Xu=class{constructor(e){this.nextLiftedState=e,this.type=nl}},Zu=class{constructor(e){this.status=e,this.type=dg}},el=class{constructor(e){this.status=e,this.type=fg}};var Qs=new Ce("@ngrx/store-devtools Options"),eg=new Ce("@ngrx/store-devtools Initial Config");function pg(){return null}var tA="NgRx Store DevTools";function nA(n){let e={maxAge:!1,monitor:pg,actionSanitizer:void 0,stateSanitizer:void 0,name:tA,serialize:!1,logOnly:!1,autoPause:!1,trace:!1,traceLimit:75,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0},connectInZone:!1},t=typeof n=="function"?n():n,r=t.logOnly?{pause:!0,export:!0,test:!0}:!1,i=t.features||r||e.features;i.import===!0&&(i.import="custom");let o=Object.assign({},e,{features:i},t);if(o.maxAge&&o.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${o.maxAge}`);return o}function tg(n,e){return n.filter(t=>e.indexOf(t)<0)}function mg(n){let{computedStates:e,currentStateIndex:t}=n;if(t>=e.length){let{state:i}=e[e.length-1];return i}let{state:r}=e[t];return r}function ni(n){return new Hn(n,+Date.now())}function rA(n,e){return Object.keys(e).reduce((t,r)=>{let i=Number(r);return t[i]=gg(n,e[i],i),t},{})}function gg(n,e,t){return Ue(Te({},e),{action:n(e.action,t)})}function iA(n,e){return e.map((t,r)=>({state:_g(n,t.state,r),error:t.error}))}function _g(n,e,t){return n(e,t)}function yg(n){return n.predicate||n.actionsSafelist||n.actionsBlocklist}function sA(n,e,t,r){let i=[],o={},a=[];return n.stagedActionIds.forEach((u,h)=>{let d=n.actionsById[u];d&&(h&&rl(n.computedStates[h],d,e,t,r)||(o[u]=d,i.push(u),a.push(n.computedStates[h])))}),Ue(Te({},n),{stagedActionIds:i,actionsById:o,computedStates:a})}function rl(n,e,t,r,i){let o=t&&!t(n,e.action),a=r&&!e.action.type.match(r.map(h=>ng(h)).join("|")),u=i&&e.action.type.match(i.map(h=>ng(h)).join("|"));return o||a||u}function ng(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ig(n){return{ngZone:n?oe(Ve):null,connectInZone:n}}var Js=(()=>{let e=class e extends Si{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=Ch(e)))(o||e)}})(),e.\u0275prov=_e({token:e,factory:e.\u0275fac});let n=e;return n})(),Gs={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},tl=new Ce("@ngrx/store-devtools Redux Devtools Extension"),vg=(()=>{let e=class e{constructor(r,i,o){this.config=i,this.dispatcher=o,this.zoneConfig=Ig(this.config.connectInZone),this.devtoolsExtension=r,this.createActionStreams()}notify(r,i){if(this.devtoolsExtension)if(r.type===ri){if(i.isLocked||i.isPaused)return;let o=mg(i);if(yg(this.config)&&rl(o,r,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;let a=this.config.stateSanitizer?_g(this.config.stateSanitizer,o,i.currentStateIndex):o,u=this.config.actionSanitizer?gg(this.config.actionSanitizer,r,i.nextActionId):r;this.sendToReduxDevtools(()=>this.extensionConnection.send(u,a))}else{let o=Ue(Te({},i),{stagedActionIds:i.stagedActionIds,actionsById:this.config.actionSanitizer?rA(this.config.actionSanitizer,i.actionsById):i.actionsById,computedStates:this.config.stateSanitizer?iA(this.config.stateSanitizer,i.computedStates):i.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,o,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new yt(r=>{let i=this.zoneConfig.connectInZone?this.zoneConfig.ngZone.runOutsideAngular(()=>this.devtoolsExtension.connect(this.getExtensionConfig(this.config))):this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=i,i.init(),i.subscribe(o=>r.next(o)),i.unsubscribe}):uh}createActionStreams(){let r=this.createChangesObservable().pipe(Ih()),i=r.pipe(qe(m=>m.type===Gs.START)),o=r.pipe(qe(m=>m.type===Gs.STOP)),a=r.pipe(qe(m=>m.type===Gs.DISPATCH),Pe(m=>this.unwrapAction(m.payload)),dh(m=>m.type===nl?this.dispatcher.pipe(qe(g=>g.type===Do),hh(1e3),fh(1e3),Pe(()=>m),ze(()=>pr(m)),wi(1)):pr(m))),h=r.pipe(qe(m=>m.type===Gs.ACTION),Pe(m=>this.unwrapAction(m.payload))).pipe(Ti(o)),d=a.pipe(Ti(o));this.start$=i.pipe(Ti(o)),this.actions$=this.start$.pipe(Ft(()=>h)),this.liftedActions$=this.start$.pipe(Ft(()=>d))}unwrapAction(r){return typeof r=="string"?(0,eval)(`(${r})`):r}getExtensionConfig(r){let i={name:r.name,features:r.features,serialize:r.serialize,autoPause:r.autoPause??!1,trace:r.trace??!1,traceLimit:r.traceLimit??75};return r.maxAge!==!1&&(i.maxAge=r.maxAge),i}sendToReduxDevtools(r){try{r()}catch(i){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",i)}}};e.\u0275fac=function(i){return new(i||e)(te(tl),te(Qs),te(Js))},e.\u0275prov=_e({token:e,factory:e.\u0275fac});let n=e;return n})(),Ks={type:ko},oA="@ngrx/store-devtools/recompute",aA={type:oA};function Eg(n,e,t,r,i){if(r)return{state:t,error:"Interrupted by an error up the chain"};let o=t,a;try{o=n(t,e)}catch(u){a=u.toString(),i.handleError(u)}return{state:o,error:a}}function Hs(n,e,t,r,i,o,a,u,h){if(e>=n.length&&n.length===o.length)return n;let d=n.slice(0,e),m=o.length-(h?1:0);for(let g=e;g<m;g++){let w=o[g],C=i[w].action,S=d[g-1],k=S?S.state:r,N=S?S.error:void 0,F=a.indexOf(w)>-1?S:Eg(t,C,k,N,u);d.push(F)}return h&&d.push(n[n.length-1]),d}function cA(n,e){return{monitorState:e(void 0,{}),nextActionId:1,actionsById:{0:ni(Ks)},stagedActionIds:[0],skippedActionIds:[],committedState:n,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function uA(n,e,t,r,i={}){return o=>(a,u)=>{let{monitorState:h,actionsById:d,nextActionId:m,stagedActionIds:g,skippedActionIds:w,committedState:C,currentStateIndex:S,computedStates:k,isLocked:N,isPaused:U}=a||e;a||(d=Object.create(d));function F(H){let M=H,v=g.slice(1,M+1);for(let p=0;p<v.length;p++)if(k[p+1].error){M=p,v=g.slice(1,M+1);break}else delete d[v[p]];w=w.filter(p=>v.indexOf(p)===-1),g=[0,...g.slice(M+1)],C=k[M].state,k=k.slice(M),S=S>M?S-M:0}function $(){d={0:ni(Ks)},m=1,g=[0],w=[],C=k[S].state,S=0,k=[]}let V=0;switch(u.type){case dg:{N=u.status,V=1/0;break}case fg:{U=u.status,U?(g=[...g,m],d[m]=new Hn({type:"@ngrx/devtools/pause"},+Date.now()),m++,V=g.length-1,k=k.concat(k[k.length-1]),S===g.length-2&&S++,V=1/0):$();break}case sg:{d={0:ni(Ks)},m=1,g=[0],w=[],C=n,S=0,k=[];break}case ag:{$();break}case og:{d={0:ni(Ks)},m=1,g=[0],w=[],S=0,k=[];break}case ug:{let{id:H}=u;w.indexOf(H)===-1?w=[H,...w]:w=w.filter(v=>v!==H),V=g.indexOf(H);break}case eA:{let{start:H,end:M,active:v}=u,p=[];for(let _=H;_<M;_++)p.push(_);v?w=tg(w,p):w=[...w,...p],V=g.indexOf(H);break}case lg:{S=u.index,V=1/0;break}case hg:{let H=g.indexOf(u.actionId);H!==-1&&(S=H),V=1/0;break}case cg:{g=tg(g,w),w=[],S=Math.min(S,g.length-1);break}case ri:{if(N)return a||e;if(U||a&&rl(a.computedStates[S],u,i.predicate,i.actionsSafelist,i.actionsBlocklist)){let M=k[k.length-1];k=[...k.slice(0,-1),Eg(o,u.action,M.state,M.error,t)],V=1/0;break}i.maxAge&&g.length===i.maxAge&&F(1),S===g.length-1&&S++;let H=m++;d[H]=u,g=[...g,H],V=g.length-1;break}case nl:{({monitorState:h,actionsById:d,nextActionId:m,stagedActionIds:g,skippedActionIds:w,committedState:C,currentStateIndex:S,computedStates:k,isLocked:N,isPaused:U}=u.nextLiftedState);break}case ko:{V=0,i.maxAge&&g.length>i.maxAge&&(k=Hs(k,V,o,C,d,g,w,t,U),F(g.length-i.maxAge),V=1/0);break}case Do:{if(k.filter(M=>M.error).length>0)V=0,i.maxAge&&g.length>i.maxAge&&(k=Hs(k,V,o,C,d,g,w,t,U),F(g.length-i.maxAge),V=1/0);else{if(!U&&!N){S===g.length-1&&S++;let M=m++;d[M]=new Hn(u,+Date.now()),g=[...g,M],V=g.length-1,k=Hs(k,V,o,C,d,g,w,t,U)}k=k.map(M=>Ue(Te({},M),{state:o(M.state,aA)})),S=g.length-1,i.maxAge&&g.length>i.maxAge&&F(g.length-i.maxAge),V=1/0}break}default:{V=1/0;break}}return k=Hs(k,V,o,C,d,g,w,t,U),h=r(h,u),{monitorState:h,actionsById:d,nextActionId:m,stagedActionIds:g,skippedActionIds:w,committedState:C,currentStateIndex:S,computedStates:k,isLocked:N,isPaused:U}}}var rg=(()=>{let e=class e{constructor(r,i,o,a,u,h,d,m){let g=cA(d,m.monitor),w=uA(d,g,h,m.monitor,m),C=mn(mn(i.asObservable().pipe(vh(1)),a.actions$).pipe(Pe(ni)),r,a.liftedActions$).pipe(fr(Ei)),S=o.pipe(Pe(w)),k=Ig(m.connectInZone),N=new ah(1);this.liftedStateSubscription=C.pipe(Eh(S),ig(k),yh(({state:$},[V,H])=>{let M=H($,V);return V.type!==ri&&yg(m)&&(M=sA(M,m.predicate,m.actionsSafelist,m.actionsBlocklist)),a.notify(V,M),{state:M,action:V}},{state:g,action:null})).subscribe(({state:$,action:V})=>{if(N.next($),V.type===ri){let H=V.action;u.next(H)}}),this.extensionStartSubscription=a.start$.pipe(ig(k)).subscribe(()=>{this.refresh()});let U=N.asObservable(),F=U.pipe(Pe(mg));Object.defineProperty(F,"state",{value:Uh(F,{manualCleanup:!0,requireSync:!0})}),this.dispatcher=r,this.liftedState=U,this.state=F}ngOnDestroy(){this.liftedStateSubscription.unsubscribe(),this.extensionStartSubscription.unsubscribe()}dispatch(r){this.dispatcher.next(r)}next(r){this.dispatcher.next(r)}error(r){}complete(){}performAction(r){this.dispatch(new Hn(r,+Date.now()))}refresh(){this.dispatch(new zu)}reset(){this.dispatch(new Wu(+Date.now()))}rollback(){this.dispatch(new Gu(+Date.now()))}commit(){this.dispatch(new Hu(+Date.now()))}sweep(){this.dispatch(new Ku)}toggleAction(r){this.dispatch(new Qu(r))}jumpToAction(r){this.dispatch(new Yu(r))}jumpToState(r){this.dispatch(new Ju(r))}importState(r){this.dispatch(new Xu(r))}lockChanges(r){this.dispatch(new Zu(r))}pauseRecording(r){this.dispatch(new el(r))}};e.\u0275fac=function(i){return new(i||e)(te(Js),te(Si),te(Hh),te(vg),te(Ri),te(bi),te(zh),te(Qs))},e.\u0275prov=_e({token:e,factory:e.\u0275fac});let n=e;return n})();function ig({ngZone:n,connectInZone:e}){return t=>e?new yt(r=>t.subscribe({next:i=>n.run(()=>r.next(i)),error:i=>n.run(()=>r.error(i)),complete:()=>n.run(()=>r.complete())})):t}var lA=new Ce("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function hA(n,e){return!!n||e.monitor!==pg}function dA(){let n="__REDUX_DEVTOOLS_EXTENSION__";return typeof window=="object"&&typeof window[n]<"u"?window[n]:null}function fA(n){return n.state}function wg(n={}){return We([vg,Js,rg,{provide:eg,useValue:n},{provide:lA,deps:[tl,Qs],useFactory:hA},{provide:tl,useFactory:dA},{provide:Qs,deps:[eg],useFactory:nA},{provide:Qh,deps:[rg],useFactory:fA},{provide:Kh,useExisting:Js}])}var Tg={providers:[Sh(),Oh(),$h(zm),Fh(Mh()),Lh(),Cd(()=>kd($u.firebase)),Lf(()=>Ff()),Bm(()=>$m()),{provide:Vh,useClass:$s,multi:!0},Jh({auth:Zm}),Xm([Ws]),wg({maxAge:25,logOnly:$u.production})]};var Ys=class n{title=Rh("application");static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Dh({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,r){t&1&&Nh(0,"router-outlet")},dependencies:[jh],encapsulation:2})};xh(Ys,Tg).catch(n=>console.error(n));
